<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Cassandra压力测试 | zqhxuyuan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="cassandra-stress 介绍 单节点测试 写入测试 采用cql3协议写入 读取测试 没有预热读取 给定一段时间测试最大可以读取多少条记录 混合模式读大于写 混合模式写大于读   自定义schema 示例 只有写入 读写混合模式 只有读取   G1测试 集群测试   YCSB">
<meta name="keywords" content="cassandra">
<meta property="og:type" content="article">
<meta property="og:title" content="Cassandra压力测试">
<meta property="og:url" content="http://github.com/zqhxuyuan/2015/10/15/Cassandra-Stress/index.html">
<meta property="og:site_name" content="zqhxuyuan">
<meta property="og:description" content="cassandra-stress 介绍 单节点测试 写入测试 采用cql3协议写入 读取测试 没有预热读取 给定一段时间测试最大可以读取多少条记录 混合模式读大于写 混合模式写大于读   自定义schema 示例 只有写入 读写混合模式 只有读取   G1测试 集群测试   YCSB">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-02-14T13:42:29.307Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cassandra压力测试">
<meta name="twitter:description" content="cassandra-stress 介绍 单节点测试 写入测试 采用cql3协议写入 读取测试 没有预热读取 给定一段时间测试最大可以读取多少条记录 混合模式读大于写 混合模式写大于读   自定义schema 示例 只有写入 读写混合模式 只有读取   G1测试 集群测试   YCSB">
  
    <link rel="alternative" href="/atom.xml" title="zqhxuyuan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">任何忧伤,都抵不过世界的美丽</a></h1>
		</hgroup>

		
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives/">归档</a></li>
				        
							<li><a href="/tags/">标签</a></li>
				        
							<li><a href="/about/">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="新浪微博"><a class="新浪微博" target="_blank" href="http://weibo.com/xuyuantree" title="新浪微博"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/apex/" style="font-size: 10px;">apex</a> <a href="/tags/bigdata/" style="font-size: 10px;">bigdata</a> <a href="/tags/book/" style="font-size: 10px;">book</a> <a href="/tags/cassandra/" style="font-size: 18.89px;">cassandra</a> <a href="/tags/clojure/" style="font-size: 10px;">clojure</a> <a href="/tags/drill/" style="font-size: 16.67px;">drill</a> <a href="/tags/druid/" style="font-size: 13.33px;">druid</a> <a href="/tags/dubbo/" style="font-size: 10px;">dubbo</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/etl/" style="font-size: 10px;">etl</a> <a href="/tags/geode/" style="font-size: 10px;">geode</a> <a href="/tags/graph/" style="font-size: 12.22px;">graph</a> <a href="/tags/hadoop/" style="font-size: 11.11px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 15.56px;">hbase</a> <a href="/tags/ignite/" style="font-size: 10px;">ignite</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/kafka/" style="font-size: 20px;">kafka</a> <a href="/tags/midd/" style="font-size: 10px;">midd</a> <a href="/tags/ops/" style="font-size: 12.22px;">ops</a> <a href="/tags/redis/" style="font-size: 11.11px;">redis</a> <a href="/tags/rocketmq/" style="font-size: 10px;">rocketmq</a> <a href="/tags/scala/" style="font-size: 13.33px;">scala</a> <a href="/tags/spark/" style="font-size: 17.78px;">spark</a> <a href="/tags/storm/" style="font-size: 17.78px;">storm</a> <a href="/tags/tcc/" style="font-size: 10px;">tcc</a> <a href="/tags/timeseries/" style="font-size: 12.22px;">timeseries</a> <a href="/tags/work/" style="font-size: 14.44px;">work</a> <a href="/tags/流处理/" style="font-size: 11.11px;">流处理</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">BIG(DATA)</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">任何忧伤,都抵不过世界的美丽</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="回到主页">任何忧伤,都抵不过世界的美丽</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives/">归档</a></li>
		        
					<li><a href="/tags/">标签</a></li>
		        
					<li><a href="/about/">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="新浪微博"><a class="新浪微博" target="_blank" href="http://weibo.com/xuyuantree" title="新浪微博"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-Cassandra-Stress" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/15/Cassandra-Stress/" class="article-date">
  	<time datetime="2015-10-14T16:00:00.000Z" itemprop="datePublished">2015-10-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Cassandra压力测试
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/work/">work</a>
	</div>


        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cassandra/">cassandra</a></li></ul>
	</div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <!-- MarkdownTOC -->
<ul>
<li>cassandra-stress<ul>
<li>介绍</li>
<li>单节点测试<ul>
<li>写入测试</li>
<li>采用cql3协议写入</li>
<li>读取测试</li>
<li>没有预热读取</li>
<li>给定一段时间测试最大可以读取多少条记录</li>
<li>混合模式读大于写</li>
<li>混合模式写大于读</li>
</ul>
</li>
<li>自定义schema<ul>
<li>示例</li>
<li>只有写入</li>
<li>读写混合模式</li>
<li>只有读取</li>
</ul>
</li>
<li>G1测试</li>
<li>集群测试</li>
</ul>
</li>
<li>YCSB</li>
</ul>
<!-- /MarkdownTOC -->
<a id="more"></a>
<h2 id="cassandra-stress">cassandra-stress</h2><p>机器配置：SSD，RAID0，62G内存，24核CPU<br>默认JVM配置：-Xms8192M -Xmx8192M -Xmn2048M<br>C版本：2.2.6，–&gt; 3.6</p>
<blockquote>
<p>说明：Cassandra对于内存的计算方式是如果超过8G，则堆的最大内存只能配置8G，而新生代的内存为堆内存的1/4=2G</p>
</blockquote>
<p>准备测试目录，修改配置文件的directory选项，把localhost相关的地址改成实际地址，便于后面集群模式（确保集群seeds一致）：</p>
<table>
<thead>
<tr>
<th>节点数量</th>
<th>种子节点</th>
<th>集群名称</th>
<th>自定义配置文件</th>
</tr>
</thead>
<tbody>
<tr>
<td>单节点</td>
<td>10.21.21.10</td>
<td>TestBenchmark1</td>
<td>blogpost1.yaml</td>
</tr>
<tr>
<td>四节点</td>
<td>10.21.21.130</td>
<td>TestBenchmark</td>
<td>blogpost4.yaml</td>
</tr>
</tbody>
</table>
<blockquote>
<p>为什么单节点和多节点采用不同的集群名称，因为不止测试一次，可能要更改GC配置，再次测试，如果只用一个集群名称，从一个节点增加到四个节点后，如果要再测试一个节点的就比较麻烦。</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.47.211:8000/apache-cassandra-2.2.6-bin.tar.gz &amp;&amp; tar zxf apache-cassandra-2.2.6-bin.tar.gz</span><br><span class="line"></span><br><span class="line">cluster=TestBenchmark1  <span class="comment">#TestBenchmark</span></span><br><span class="line">seeds=10.21.21.10       <span class="comment">#10.21.21.130</span></span><br><span class="line"></span><br><span class="line">mkdir <span class="built_in">test</span></span><br><span class="line">host=`ifconfig | grep <span class="string">"10.21.21."</span> | awk <span class="string">'/inet addr/&#123;sub("addr:",""); print $2&#125;'</span>`</span><br><span class="line">sed -i -e <span class="string">"s/localhost/<span class="variable">$host</span>/g"</span> apache-cassandra-2.2.6/conf/cassandra.yaml</span><br><span class="line">sed -i -e <span class="string">"s#localhost#<span class="variable">$host</span>#g"</span> apache-cassandra-2.2.6/conf/cassandra-env.sh</span><br><span class="line">sed -i -e <span class="string">"s/127.0.0.1/<span class="variable">$seeds</span>/g"</span> apache-cassandra-2.2.6/conf/cassandra.yaml</span><br><span class="line">sed -i -e <span class="string">"s/Test Cluster/<span class="variable">$cluster</span>/g"</span> apache-cassandra-2.2.6/conf/cassandra.yaml</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"data_file_directories: [/home/admin/test/data]"</span> &gt;&gt; apache-cassandra-2.2.6/conf/cassandra.yaml</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"saved_caches_directory: /home/admin/test/saved_caches"</span> &gt;&gt; apache-cassandra-2.2.6/conf/cassandra.yaml</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"commitlog_directory: /home/admin/test/commitlog"</span> &gt;&gt; apache-cassandra-2.2.6/conf/cassandra.yaml</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"auto_bootstrap: false"</span> &gt;&gt; apache-cassandra-2.2.6/conf/cassandra.yaml</span><br></pre></td></tr></table></figure>
<p>为了测试的准确性，不要在按照有Cassandra的当前节点做压力测试，可以在集群之外安装一个Cassandra，<br>但是注意不要启动他，使用cassandra-stress的-node连接到目标集群也可以测试。  </p>
<h3 id="介绍">介绍</h3><p>Cassandra从很早的版本就自带了cassandra-stress压力测试工具，它的使用方法在cassandra-stress后添加命令和选项。<br>其中常用的命令一般只用到：write、read、mixed、user。其中单纯的write和read只测试读和写，mixed则测试同时读写。<br>user是2.1之后新增的，通过自定义配置文件，在配置文件中可以指定insert和query查询语句。<br>命令command没有以<code>-</code>开头，而选项[options]有两种方式：<code>-选项名称 选项值</code>或者<code>选项名称=选项值</code>。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd apache-cassandra-2.2.6/tools/bin/</span><br><span class="line">cassandra-stress command [options]</span><br></pre></td></tr></table></figure>
<p>常用的选项有</p>
<ol>
<li><code>线程数量</code>：-rate threads=? [limit=?]，比如<code>-rate threads=100</code></li>
<li><code>表结构设置</code>：<code>-schema [replication(?)] [keyspace=?] [compaction(?)] [compression=?]</code></li>
<li><code>日志设置</code>：-log level=verbose</li>
<li><code>运行模式</code>的几种示例，因为Cassandra本身提供了多种交互方式比如thrift协议，CQL协议等  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-mode thrift [smart]</span><br><span class="line">-mode native [unprepared] cql3 [compression=?]</span><br><span class="line">-mode simplenative [prepared] cql3</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在2.1.5之后，添加了一些选项（通常针对user命令）  </p>
<ol>
<li>profile=?：指定YAML配置文件，需要自己编写DML，插入，查询</li>
<li>ops(?)：指定操作类型和数量，比如ops(inserts=1)，或者ops(queries=2)，其中queries需要用指定的查询名称代替</li>
<li>n=?：指定操作数量，比如要写入10万条数据，n=100000； 要读取1000条数据，n=1000</li>
<li>truncate=?，是否需要清空表，可选项有：never(默认值),one,always</li>
<li>cl=?：一致性级别，可选项有：ONE,QUORUM,LOCAL_QUORUM,EACH_QUORUM,ALL,ANY,LOCAL_ONE(默认值)</li>
</ol>
<p>注意选项名称1=选项值必须放在-选项名称2 选项值前面，如果把选项名称1放在后面，会被认为作为选项名称2的子选项。<br>比如正确的用法：truncate=one -node xxx，而不能是：-node xxx truncate=one，后者会认为是-node的子选项。  </p>
<p>一个示例：写入100万条数据，一致性级别为Local_Quorum，客户端线程数=500个，32个列，副本数据=3个</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cassandra-stress write n=1000000 cl=LOCAL_QUORUM -rate threads=500 \</span><br><span class="line">    -col &quot;size=fixed(2048)&quot; &quot;n=fixed(32)&quot; -schema &quot;replication(factor=3)&quot; -node 192.168.10.12</span><br></pre></td></tr></table></figure>
<h3 id="单节点测试">单节点测试</h3><p>一键测试命令：nohup sh stress1.sh &gt; stress1.log 2&gt;&amp;1 &amp;</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">/home/admin/apache-cassandra-2.2.6/bin/nodetool -h 10.21.21.10 status</span><br><span class="line"><span class="built_in">cd</span> /home/admin/apache-cassandra-2.2.6/tools/bin</span><br><span class="line"><span class="comment">#标准测试</span></span><br><span class="line"><span class="comment">########</span></span><br><span class="line">./cassandra-stress write n=1000000 -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE1_write_1M.log</span><br><span class="line">./cassandra-stress <span class="built_in">read</span> n=200000 -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE2_read_2.log</span><br><span class="line">./cassandra-stress <span class="built_in">read</span> n=200000 no-warmup -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE3_read_2_nowarm.log</span><br><span class="line">./cassandra-stress <span class="built_in">read</span> duration=3m -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE4_read_3min.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#混合模式</span></span><br><span class="line"><span class="comment">########</span></span><br><span class="line"><span class="comment">#./cassandra-stress write n=1 cl=one -mode native cql3 -log file=SINGLENODE_create_schema.log -node 10.21.21.10</span></span><br><span class="line"><span class="comment">#./cassandra-stress write n=1000000 cl=one -mode native cql3 -schema keyspace="keyspace1" -log file=SINGLENODE5_write_1M_rows.log -node 10.21.21.10</span></span><br><span class="line"></span><br><span class="line">./cassandra-stress mixed ratio\(write=1,<span class="built_in">read</span>=3\) n=100000 cl=ONE -pop dist=UNIFORM\(1..1000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 threads\&lt;=256 -<span class="built_in">log</span> file=SINGLENODE5_mixed_write1read3_1M.log -node 10.21.21.10</span><br><span class="line">./cassandra-stress mixed ratio\(write=3,<span class="built_in">read</span>=1\) n=100000 cl=ONE -pop dist=UNIFORM\(1..1000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 threads\&lt;=256 -<span class="built_in">log</span> file=SINGLENODE6_mixed_write3read1_1M.log -node 10.21.21.10</span><br><span class="line"></span><br><span class="line"><span class="comment">#./cassandra-stress write n=1000000 cl=one -mode native cql3 -schema keyspace="keyspace1" -pop seq=1..1000000 -node 10.21.21.10</span></span><br><span class="line"><span class="comment">#./cassandra-stress read n=1000000 cl=one -mode native cql3 -schema keyspace="keyspace1" -pop seq=1..1000000 -node 10.21.21.10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#自定义表</span></span><br><span class="line"><span class="comment">########</span></span><br><span class="line">./cassandra-stress user profile=./blogpost1.yaml ops\(insert=1\) -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE7_blog_insert.log</span><br><span class="line">./cassandra-stress user profile=./blogpost1.yaml ops\(singlepost=2,timeline=1,insert=1\) -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE8_blog_mixed.log</span><br><span class="line">./cassandra-stress user profile=./blogpost1.yaml ops\(singlepost=1\) -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE9_blog_q1.log</span><br><span class="line">./cassandra-stress user profile=./blogpost1.yaml ops\(timeline=1\) -node 10.21.21.10 -<span class="built_in">log</span> file=SINGLENODE10_blog_q2.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#支持图形显示结果（3.2以上支持）</span></span><br><span class="line"><span class="comment">########</span></span><br><span class="line"><span class="comment">#cassandra-stress write n=100000 -rate threads=10 -graph file=example-benchmark.html title=example revision=benchmark-0</span></span><br><span class="line"><span class="comment">#cassandra-stress mixed n=100000 -rate threads=10 -graph file=example-benchmark.html title=example revision=benchmark-0</span></span><br></pre></td></tr></table></figure>
<h4 id="写入测试">写入测试</h4><p>测试100万条数据的写入速度：./cassandra-stress write n=1000000 -node 10.21.21.10 -log file=SINGLENODE1_write_1M.log<br>测试结果：每秒钟写入5.8万条，由于每个row key都是唯一的，所以100万条数据有100万个分区，每秒钟的写入量=每秒钟写入的分区数=每秒钟写入的行数。<br>每条记录的写延迟平均3.4ms，写延迟小于4.1ms的占比95，写延迟小于21ms的占比99%，也就是说99%的记录写延迟在21ms以下。<br>最大一条记录的写延迟为180ms。GC一共发生了5次，GC的大小为7G，GC时间花了1秒，平均GC时间为143ms。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Results: [write n=1000000], 200 threads</span><br><span class="line">op rate                   : 57901 [WRITE:57901]</span><br><span class="line">partition rate            : 57901 [WRITE:57901]</span><br><span class="line">row rate                  : 57901 [WRITE:57901]</span><br><span class="line">latency mean              : 3.4 [WRITE:3ps.4]</span><br><span class="line">latency median            : 3.2 [WRITE:3.2]</span><br><span class="line">latency 95th percentile   : 4.1 [WRITE:4.1]</span><br><span class="line">latency 99th percentile   : 5.1 [WRITE:5.1]</span><br><span class="line">latency 99.9th percentile : 21.3 [WRITE:21.3]</span><br><span class="line">latency max               : 180.1 [WRITE:180.1]</span><br><span class="line">Total partitions          : 1000000 [WRITE:1000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 5</span><br><span class="line">total gc mb               : 7362</span><br><span class="line">total gc time (s)         : 1</span><br><span class="line">avg gc time(ms)           : 143</span><br><span class="line">stdev gc time(ms)         : 42</span><br><span class="line">Total operation time      : 00:00:17</span><br></pre></td></tr></table></figure>
<p>客户端在集群之外测试时，每秒钟的写入量增大到11万。不过GC大小和时间没有多大变化，当然因为每秒钟写入量增多，总共10万条数据，花费的时间也就不同了。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">op rate                   : 114509 [WRITE:114509]</span><br><span class="line">partition rate            : 114509 [WRITE:114509]</span><br><span class="line">row rate                  : 114509 [WRITE:114509]</span><br><span class="line">latency mean              : 1.7 [WRITE:1.7]</span><br><span class="line">latency median            : 1.4 [WRITE:1.4]</span><br><span class="line">latency 95th percentile   : 2.0 [WRITE:2.0]</span><br><span class="line">latency 99th percentile   : 3.0 [WRITE:3.0]</span><br><span class="line">latency 99.9th percentile : 110.1 [WRITE:110.1]</span><br><span class="line">latency max               : 191.8 [WRITE:191.8]</span><br><span class="line">Total partitions          : 1000000 [WRITE:1000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 5</span><br><span class="line">total gc mb               : 7351</span><br><span class="line">total gc time (s)         : 1</span><br><span class="line">avg gc time(ms)           : 147</span><br><span class="line">stdev gc time(ms)         : 34</span><br><span class="line">Total operation time      : 00:00:08</span><br></pre></td></tr></table></figure>
<h4 id="采用cql3协议写入">采用cql3协议写入</h4><p>./cassandra-stress write n=1000000 cl=one -mode native cql3 -schema keyspace=”keyspace1” -log file=SINGLENODE5_write_1M_rows.log -node 10.21.21.10<br>测试结果：基本上和默认的模式是一样的，那么默认的模式是什么类型的？  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">op rate                   : 123953 [WRITE:123953]</span><br><span class="line">partition rate            : 123953 [WRITE:123953]</span><br><span class="line">row rate                  : 123953 [WRITE:123953]</span><br><span class="line">latency mean              : 1.6 [WRITE:1.6]</span><br><span class="line">latency median            : 1.4 [WRITE:1.4]</span><br><span class="line">latency 95th percentile   : 1.8 [WRITE:1.8]</span><br><span class="line">latency 99th percentile   : 2.5 [WRITE:2.5]</span><br><span class="line">latency 99.9th percentile : 18.7 [WRITE:18.7]</span><br><span class="line">latency max               : 201.6 [WRITE:201.6]</span><br><span class="line">Total partitions          : 1000000 [WRITE:1000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 4</span><br><span class="line">total gc mb               : 5753</span><br><span class="line">total gc time (s)         : 1</span><br><span class="line">avg gc time(ms)           : 165</span><br><span class="line">stdev gc time(ms)         : 39</span><br><span class="line">Total operation time      : 00:00:08</span><br></pre></td></tr></table></figure>
<p>可能是由于数量太小（100万还不小？可以设置为500万，差不多需要7分钟），更改内存，基本上看不出差别。</p>
<h4 id="读取测试">读取测试</h4><p>读取20万条记录：./cassandra-stress read n=200000 -node 10.21.21.10 -log file=SINGLENODE2_read_2.log<br>测试结果：使用121个线程时，每秒最大可以读取8万条数据，平均每条读取时间1.4ms，99.9%的读取时间在2ms内，<br>读取时间最长的那条记录花了21ms，GC发生了一次，花费了14ms。<br>问题：为什么读取也会有GC？ 因为读取时会先把数据放到内存，然后才会返回给客户端。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   24220,   24220,   24220,     0.2,     0.1,     0.2,     0.2,     0.3,    40.3,    8.3,  0.01704,      0,      2,      69,      69,       5,    3380</span><br><span class="line">  8 threadCount, READ,         200000,   44524,   44524,   44524,     0.2,     0.2,     0.2,     0.2,     0.3,    26.7,    4.5,  0.01377,      0,      1,      25,      25,       0,    1640</span><br><span class="line"> 16 threadCount, READ,         200000,   66583,   66583,   66583,     0.2,     0.2,     0.3,     0.3,     1.1,    32.3,    3.0,  0.01140,      0,      2,      16,      29,       2,    1646</span><br><span class="line"> 24 threadCount, READ,         200000,   71464,   71464,   71464,     0.3,     0.3,     0.4,     0.5,     0.7,    19.1,    2.8,  0.02220,      0,      1,      13,      13,       0,    1638</span><br><span class="line"> 36 threadCount, READ,         200000,   74215,   74215,   74215,     0.5,     0.5,     0.6,     0.8,     1.1,    16.2,    2.7,  0.02348,      0,      1,      15,      15,       0,    1637</span><br><span class="line"> 54 threadCount, READ,         200000,   75220,   75220,   75220,     0.7,     0.7,     0.9,     1.0,     1.6,    16.4,    2.7,  0.00871,      0,      2,      28,      28,       0,    3276</span><br><span class="line"> 81 threadCount, READ,         200000,   77820,   77820,   77820,     1.0,     1.0,     1.3,     1.6,     7.0,    17.6,    2.6,  0.02741,      0,      1,      15,      15,       0,    1638</span><br><span class="line">121 threadCount, READ,         200000,   83228,   83228,   83228,     1.4,     1.4,     1.6,     1.7,     2.0,    21.0,    2.4,  0.00911,      0,      1,      14,      14,       0,    1638</span><br><span class="line">181 threadCount, READ,         200000,   77173,   77173,   77173,     2.3,     2.4,     2.7,     3.2,    16.7,    18.6,    2.6,  0.01297,      0,      1,      14,      14,       0,    1638</span><br><span class="line">271 threadCount, READ,         200000,   71700,   71700,   71700,     3.8,     3.6,     4.9,     5.7,    18.7,    20.6,    2.8,  0.02096,      0,      1,      13,      13,       0,    1638</span><br></pre></td></tr></table></figure>
<p>上面是stress客户端和Cassandra运行在同一个节点，客户端本身消耗一定的资源，下面是客户端在集群之外的测试：<br>测试结果：线程数量在181时达到最大，因为客户端在集群里面本身开启一些测试线程，把客户端排除在外后，可用的线程数增大。<br>在181个线程下，每秒钟最大可以读取13万条，99.9%的读取时间在2.5ms，GC一次花了14ms。<br>可以看到跟上面的结果是差不多的，只不过因为客户端线程本身占用了一些线程，导致没有达到最大线程。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   19522,   19522,   19522,     0.2,     0.2,     0.2,     0.3,     0.6,    37.4,   10.2,  0.01172,      0,      2,      67,      67,       3,    3265</span><br><span class="line">  8 threadCount, READ,         200000,   32361,   32361,   32361,     0.2,     0.2,     0.3,     0.3,     0.4,    26.4,    6.2,  0.00157,      0,      1,      25,      25,       0,    1638</span><br><span class="line"> 16 threadCount, READ,         200000,   48620,   48620,   48620,     0.3,     0.3,     0.4,     0.5,     0.6,    18.9,    4.1,  0.01178,      0,      1,      17,      17,       0,    1636</span><br><span class="line"> 24 threadCount, READ,         200000,   56026,   56026,   56026,     0.4,     0.4,     0.5,     0.6,     0.8,    17.7,    3.6,  0.00253,      0,      2,      32,      32,       1,    3276</span><br><span class="line"> 36 threadCount, READ,         200000,   70923,   70923,   70923,     0.5,     0.5,     0.6,     0.7,     0.8,    16.9,    2.8,  0.00233,      0,      1,      15,      15,       0,    1638</span><br><span class="line"> 54 threadCount, READ,         200000,   86152,   86152,   86152,     0.6,     0.6,     0.8,     0.8,     0.9,    16.8,    2.3,  0.01160,      0,      1,      15,      15,       0,    1638</span><br><span class="line"> 81 threadCount, READ,         200000,  103282,  103282,  103282,     0.8,     0.7,     1.0,     1.0,     1.2,    21.5,    1.9,  0.00076,      0,      1,      15,      15,       0,    1638</span><br><span class="line">121 threadCount, READ,         200000,  123607,  123607,  123607,     1.0,     0.9,     1.3,     1.5,    22.9,    31.2,    1.6,  0.01687,      0,      1,      14,      14,       0,    1638</span><br><span class="line">181 threadCount, READ,         200000,  134298,  134298,  134298,     1.3,     1.2,     1.8,     2.1,     2.5,    27.6,    1.5,  0.00338,      0,      1,      14,      14,       0,    1638</span><br><span class="line">271 threadCount, READ,         200000,  132761,  132761,  132761,     2.1,     1.8,     2.9,     3.2,    17.7,    25.8,    1.5,  0.01147,      0,      2,      28,      28,       0,    3276</span><br><span class="line">406 threadCount, READ,         200000,  121970,  121970,  121970,     3.3,     3.1,     4.7,     5.6,    37.4,    39.2,    1.6,  0.04408,      0,      1,      14,      14,       0,    1638</span><br></pre></td></tr></table></figure>
<blockquote>
<p>问题：这里的线程数是什么含义？跟Cassandra本身的concurrent_reads有没有什么关系，如果更了concurrent_reads，这里的线程数会不会有影响？<br>答：这里的线程指的应该是客户端线程数，就好比多个客户端同时要查询Cassandra，实际中是API分布在多台机器上，每台机器都会查询Cassandra。所以线程数指的是可以允许多少个客户端同时查询。</p>
</blockquote>
<p>又测试一次，看起来很上面差不多，不过不同的是.999的读取时间在81个线程-271个线程不断递增，而上面在181线程却降下来了。<br>实际上即使每次测试，结果也是不同的，不过可以测试多次，观察相同的现象，从而得出最优的线程。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   20232,   20232,   20232,     0.2,     0.2,     0.2,     0.3,     0.3,    29.9,    9.9,  0.00875,      0,      2,      56,      56,       1,    3408</span><br><span class="line">  8 threadCount, READ,         200000,   31871,   31871,   31871,     0.2,     0.2,     0.3,     0.4,     0.4,    24.8,    6.3,  0.00596,      0,      1,      24,      24,       0,    1640</span><br><span class="line"> 16 threadCount, READ,         200000,   48916,   48916,   48916,     0.3,     0.3,     0.4,     0.5,     0.5,    18.4,    4.1,  0.00362,      0,      1,      16,      16,       0,    1638</span><br><span class="line"> 24 threadCount, READ,         200000,   57223,   57223,   57223,     0.4,     0.4,     0.5,     0.6,     0.6,    17.2,    3.5,  0.00869,      0,      1,      15,      15,       0,    1637</span><br><span class="line"> 36 threadCount, READ,         200000,   72069,   72069,   72069,     0.5,     0.5,     0.6,     0.7,     0.7,    15.7,    2.8,  0.00479,      0,      1,      14,      14,       0,    1638</span><br><span class="line"> 54 threadCount, READ,         200000,   84576,   84576,   84576,     0.6,     0.6,     0.8,     0.8,     8.8,    16.1,    2.4,  0.01512,      0,      2,      27,      27,       1,    3276</span><br><span class="line"> 81 threadCount, READ,         200000,   97560,   97560,   97560,     0.8,     0.8,     1.0,     1.3,    10.5,    19.3,    2.0,  0.00667,      0,      1,      13,      13,       0,    1638</span><br><span class="line">121 threadCount, READ,         200000,  124550,  124550,  124550,     1.0,     0.9,     1.3,     1.5,    11.3,    15.5,    1.6,  0.01291,      0,      1,      13,      13,       0,    1638</span><br><span class="line">181 threadCount, READ,         200000,  128233,  128233,  128233,     1.4,     1.3,     1.9,     2.2,    15.2,    26.5,    1.6,  0.02911,      0,      1,      14,      14,       0,    1638</span><br><span class="line">271 threadCount, READ,         200000,  129338,  129338,  129338,     2.1,     1.8,     3.0,     3.3,    36.4,    37.1,    1.5,  0.00817,      0,      1,      14,      14,       0,    1638</span><br><span class="line">406 threadCount, READ,         200000,  122300,  122300,  122300,     3.3,     3.1,     4.4,     5.3,    30.9,    33.7,    1.6,  0.02184,      0,      1,      14,      14,       0,    1638</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   20314,   20314,   20314,     0.2,     0.2,     0.2,     0.3,     0.3,   217.3,    9.8,  0.00695,      0,      1,     205,     205,       0,    4514</span><br><span class="line">  8 threadCount, READ,         200000,   32903,   32903,   32903,     0.2,     0.2,     0.3,     0.3,     0.5,    11.1,    6.1,  0.05020,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 16 threadCount, READ,         200000,   50563,   50563,   50563,     0.3,     0.3,     0.4,     0.5,     0.5,     8.5,    4.0,  0.00313,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, READ,         200000,   57049,   57049,   57049,     0.4,     0.4,     0.5,     0.6,     0.8,   130.7,    3.5,  0.00710,      0,      1,     129,     129,       0,    4876</span><br><span class="line"> 36 threadCount, READ,         200000,   70887,   70887,   70887,     0.5,     0.5,     0.6,     0.7,     1.2,    11.6,    2.8,  0.00415,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, READ,         200000,   86965,   86965,   86965,     0.6,     0.6,     0.8,     0.8,     1.5,    16.1,    2.3,  0.01355,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, READ,         200000,   98004,   98004,   98004,     0.8,     0.8,     1.0,     1.1,    12.4,    97.3,    2.0,  0.01691,      0,      1,      95,      95,       0,    4896</span><br><span class="line">121 threadCount, READ,         200000,  123605,  123605,  123605,     1.0,     0.9,     1.3,     1.5,     1.7,    32.3,    1.6,  0.02667,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, READ,         200000,  137328,  137328,  137328,     1.3,     1.2,     1.8,     2.1,     2.6,    13.4,    1.5,  0.00533,      0,      0,       0,       0,       0,       0</span><br><span class="line">271 threadCount, READ,         200000,  116140,  116140,  116140,     2.3,     1.9,     3.1,     3.7,   100.8,   102.4,    1.7,  0.04059,      0,      1,      98,      98,       0,    4900</span><br><span class="line">406 threadCount, READ,         200000,  117164,  117164,  117164,     3.5,     3.2,     4.6,     5.1,    82.8,    86.3,    1.7,  0.02663,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<h4 id="没有预热读取">没有预热读取</h4><p>没有预热读取20万条数据：./cassandra-stress read n=200000 no-warmup -node 10.21.21.10 -log file=SINGLENODE3_read_2_nowarm.log<br>测试结果：以181个线程为例，每秒的读取数量差不了多少，但是没有预热情况下，99.9%的读取时间在41.5ms，不过仍有99%的读取时间在2.3ms。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   19246,   19246,   19246,     0.2,     0.2,     0.3,     0.3,     0.8,    22.7,   10.4,  0.03294,      0,      1,      20,      20,       0,    1634</span><br><span class="line">  8 threadCount, READ,         200000,   31951,   31951,   31951,     0.2,     0.2,     0.3,     0.4,     0.4,    31.8,    6.3,  0.00502,      0,      1,      31,      31,       0,    1638</span><br><span class="line"> 16 threadCount, READ,         199935,   49763,   49763,   49763,     0.3,     0.3,     0.4,     0.5,     0.5,    16.4,    4.0,  0.00809,      0,      1,      15,      15,       0,    1640</span><br><span class="line"> 24 threadCount, READ,         200000,   57285,   57285,   57285,     0.4,     0.4,     0.5,     0.6,     0.7,    16.1,    3.5,  0.01034,      0,      1,      15,      15,       0,    1639</span><br><span class="line"> 36 threadCount, READ,         200000,   71017,   71017,   71017,     0.5,     0.5,     0.6,     0.7,     0.8,    15.9,    2.8,  0.00060,      0,      2,      30,      30,       0,    3277</span><br><span class="line"> 54 threadCount, READ,         200000,   84927,   84927,   84927,     0.6,     0.6,     0.8,     0.8,     1.0,    16.6,    2.4,  0.01203,      0,      1,      14,      14,       0,    1638</span><br><span class="line"> 81 threadCount, READ,         200000,  102405,  102405,  102405,     0.8,     0.8,     1.0,     1.1,     1.4,    16.6,    2.0,  0.00724,      0,      1,      14,      14,       0,    1638</span><br><span class="line">121 threadCount, READ,         200000,  113897,  113897,  113897,     1.1,     0.9,     1.3,     1.6,    52.6,    89.4,    1.8,  0.01850,      0,      1,      14,      14,       0,    1638</span><br><span class="line">181 threadCount, READ,         200000,  121195,  121195,  121195,     1.5,     1.3,     1.9,     2.3,    41.5,    61.9,    1.6,  0.02605,      0,      1,      15,      15,       0,    1638</span><br><span class="line">271 threadCount, READ,         200000,  131395,  131395,  131395,     2.1,     1.9,     2.9,     3.2,    17.5,    20.2,    1.5,  0.00003,      0,      1,      14,      14,       0,    1638</span><br><span class="line">406 threadCount, READ,         200000,  120490,  120490,  120490,     3.4,     3.3,     4.4,     7.9,    24.9,    33.7,    1.7,  0.02581,      0,      2,      28,      28,       0,    3277</span><br><span class="line">609 threadCount, READ,         200000,  113461,  113461,  113461,     5.4,     5.5,     6.9,     9.5,    41.3,    43.5,    1.8,  0.02642,      0,      1,      14,      14,       0,    1638</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   19459,   19459,   19459,     0.2,     0.2,     0.3,     0.3,     0.7,    13.6,   10.3,  0.03267,      0,      0,       0,       0,       0,       0</span><br><span class="line">  8 threadCount, READ,         200000,   31733,   31733,   31733,     0.2,     0.2,     0.3,     0.4,     0.4,    11.4,    6.3,  0.00728,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 16 threadCount, READ,         200000,   48927,   48927,   48927,     0.3,     0.3,     0.4,     0.5,     0.6,     9.0,    4.1,  0.00572,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, READ,         200000,   57267,   57267,   57267,     0.4,     0.4,     0.5,     0.6,     0.7,    10.2,    3.5,  0.00991,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, READ,         200000,   71712,   71712,   71712,     0.5,     0.5,     0.6,     0.7,     0.8,    38.8,    2.8,  0.00863,      0,      1,      37,      37,       0,    8782</span><br><span class="line"> 54 threadCount, READ,         200000,   89064,   89064,   89064,     0.6,     0.6,     0.8,     0.8,     1.2,    13.5,    2.2,  0.00836,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, READ,         200000,  101873,  101873,  101873,     0.8,     0.8,     1.0,     1.1,     1.6,    26.6,    2.0,  0.01203,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, READ,         200000,  128791,  128791,  128791,     0.9,     0.9,     1.3,     1.4,     4.5,    20.3,    1.6,  0.00524,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, READ,         200000,  136667,  136667,  136667,     1.3,     1.2,     1.8,     2.1,     5.3,    31.5,    1.5,  0.01082,      0,      0,       0,       0,       0,       0</span><br><span class="line">271 threadCount, READ,         200000,  121611,  121611,  121611,     2.2,     1.9,     3.1,     3.8,    31.1,    32.0,    1.6,  0.01160,      0,      1,      21,      21,       0,    8783</span><br><span class="line">406 threadCount, READ,         200000,  118972,  118972,  118972,     3.4,     3.6,     4.5,     5.5,    35.2,    36.3,    1.7,  0.00088,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<p>G1_24G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   19715,   19715,   19715,     0.2,     0.2,     0.2,     0.3,     0.7,    14.3,   10.1,  0.02534,      0,      0,       0,       0,       0,       0</span><br><span class="line">  8 threadCount, READ,         200000,   32683,   32683,   32683,     0.2,     0.2,     0.3,     0.3,     0.4,    10.1,    6.1,  0.00510,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 16 threadCount, READ,         200000,   49059,   49059,   49059,     0.3,     0.3,     0.4,     0.5,     0.5,     9.0,    4.1,  0.00434,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, READ,         200000,   58071,   58071,   58071,     0.4,     0.4,     0.5,     0.6,     0.6,     8.2,    3.4,  0.01215,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, READ,         200000,   71800,   71800,   71800,     0.5,     0.5,     0.6,     0.7,     5.6,    10.1,    2.8,  0.00305,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, READ,         200000,   85405,   85405,   85405,     0.6,     0.6,     0.8,     0.8,     2.5,    15.0,    2.3,  0.01252,      0,      1,      12,      12,       0,   14734</span><br><span class="line"> 81 threadCount, READ,         200000,  102288,  102288,  102288,     0.8,     0.8,     1.0,     1.1,     2.4,    10.3,    2.0,  0.00164,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, READ,         200000,  122329,  122329,  122329,     1.0,     0.9,     1.3,     1.5,    15.5,    92.1,    1.6,  0.00384,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, READ,         200000,  127409,  127409,  127409,     1.4,     1.2,     1.8,     2.0,    45.2,    83.2,    1.6,  0.02074,      0,      0,       0,       0,       0,       0</span><br><span class="line">271 threadCount, READ,         200000,  129012,  129012,  129012,     2.1,     1.8,     3.0,     3.8,    24.2,    25.1,    1.5,  0.02108,      0,      0,       0,       0,       0,       0</span><br><span class="line">406 threadCount, READ,         200000,  124542,  124542,  124542,     3.3,     3.4,     4.3,     5.1,    21.1,    22.3,    1.6,  0.01146,      0,      0,       0,       0,       0,       0</span><br><span class="line">609 threadCount, READ,         200000,  114549,  114549,  114549,     5.4,     5.5,     6.9,     7.8,    26.4,    28.6,    1.7,  0.00217,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<p>G1_32G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   18901,   18901,   18901,     0.2,     0.2,     0.3,     0.3,     0.7,    14.6,   10.6,  0.02816,      0,      0,       0,       0,       0,       0</span><br><span class="line">  8 threadCount, READ,         200000,   32102,   32102,   32102,     0.2,     0.2,     0.3,     0.3,     0.4,    13.4,    6.2,  0.00663,      0,      1,      13,      13,       0,   19629</span><br><span class="line"> 16 threadCount, READ,         199859,   49739,   49739,   49739,     0.3,     0.3,     0.4,     0.4,     0.6,     6.3,    4.0,  0.00201,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, READ,         200000,   56403,   56403,   56403,     0.4,     0.4,     0.6,     0.6,     0.7,     8.5,    3.5,  0.01001,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, READ,         200000,   72080,   72080,   72080,     0.5,     0.5,     0.6,     0.6,     0.9,     9.7,    2.8,  0.00493,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, READ,         200000,   85258,   85258,   85258,     0.6,     0.6,     0.8,     0.9,     1.3,    20.8,    2.3,  0.00435,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, READ,         200000,   96518,   96518,   96518,     0.8,     0.8,     1.0,     1.1,     1.2,    15.6,    2.1,  0.00669,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, READ,         200000,  120044,  120044,  120044,     1.0,     0.9,     1.3,     1.5,    14.7,    36.8,    1.7,  0.01983,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, READ,         200000,  129879,  129879,  129879,     1.4,     1.3,     1.7,     2.1,    23.6,    70.6,    1.5,  0.03941,      0,      0,       0,       0,       0,       0</span><br><span class="line">271 threadCount, READ,         200000,  134088,  134088,  134088,     2.0,     1.8,     2.9,     3.3,    15.9,    16.6,    1.5,  0.00226,      0,      0,       0,       0,       0,       0</span><br><span class="line">406 threadCount, READ,         200000,  120807,  120807,  120807,     3.4,     3.0,     4.6,     5.1,    51.4,    53.9,    1.7,  0.00992,      0,      1,      12,      12,       0,   19630</span><br><span class="line">609 threadCount, READ,         200000,  101774,  101774,  101774,     6.1,     5.7,     7.0,     8.2,   227.4,   229.6,    2.0,  0.00759,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<h4 id="给定一段时间测试最大可以读取多少条记录">给定一段时间测试最大可以读取多少条记录</h4><p>测试3分钟能读取多少条记录：./cassandra-stress read duration=3m -node 10.21.21.10 -log file=SINGLENODE4_read_3min.log<br>测试结果：还是181个线程时达到最大值，总共读取了2500万，99.9%的读取时间为2.4ms，GC发生了144次，最长的GC时间花了2.6s。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,        3685598,   20476,   20476,   20476,     0.2,     0.2,     0.2,     0.3,     0.3,    57.0,  180.0,  0.00144,      0,     27,     757,     757,      11,   44103</span><br><span class="line">  8 threadCount, READ,        5828269,   32379,   32379,   32379,     0.2,     0.2,     0.3,     0.3,     0.4,    25.5,  180.0,  0.00112,      0,     36,     706,     706,       1,   58974</span><br><span class="line"> 16 threadCount, READ,        8829104,   49050,   49050,   49050,     0.3,     0.3,     0.4,     0.5,     0.6,    21.7,  180.0,  0.00163,      0,     52,     979,     979,       1,   85196</span><br><span class="line"> 24 threadCount, READ,       10249086,   56939,   56939,   56939,     0.4,     0.4,     0.5,     0.6,     0.7,    37.2,  180.0,  0.00170,      0,     61,    1140,    1152,       1,   98314</span><br><span class="line"> 36 threadCount, READ,       12957013,   71983,   71983,   71983,     0.5,     0.5,     0.6,     0.6,     0.8,    21.1,  180.0,  0.00072,      0,     76,    1414,    1414,       1,  124523</span><br><span class="line"> 54 threadCount, READ,       15659754,   86997,   86997,   86997,     0.6,     0.6,     0.7,     0.8,     1.0,   101.4,  180.0,  0.00075,      0,     91,    1691,    1691,       1,  149101</span><br><span class="line"> 81 threadCount, READ,       18822803,  104569,  104569,  104569,     0.8,     0.7,     1.0,     1.0,     1.2,    36.3,  180.0,  0.00091,      0,    110,    2051,    2051,       1,  180233</span><br><span class="line">121 threadCount, READ,       20570170,  114275,  114275,  114275,     1.0,     0.9,     1.2,     1.4,     1.6,   994.0,  180.0,  0.01009,      0,    118,    2185,    2185,       1,  193341</span><br><span class="line">181 threadCount, READ,       24761012,  137557,  137557,  137557,     1.3,     1.2,     1.7,     1.9,     2.4,   150.7,  180.0,  0.00113,      0,    144,    2683,    2683,       1,  235942</span><br><span class="line">271 threadCount, READ,       24495851,  136082,  136082,  136082,     2.0,     1.8,     2.8,     3.1,    11.6,    37.0,  180.0,  0.00120,      0,    141,    2642,    2642,       1,  231027</span><br><span class="line">406 threadCount, READ,       20696670,  115470,  115470,  115470,     3.5,     3.1,     4.0,     4.5,    23.5,   883.7,  179.2,  0.01129,      0,    119,    2226,    2226,       1,  194980</span><br><span class="line">609 threadCount, READ,       20807103,  115587,  115587,  115587,     5.3,     5.4,     6.4,     6.9,    26.1,    36.5,  180.0,  0.00097,      0,    121,    2266,    2266,       1,  198256</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,        3584751,   19915,   19915,   19915,     0.2,     0.2,     0.2,     0.3,     0.3,   237.3,  180.0,  0.00161,      0,     12,    1953,    1953,      34,  103288</span><br><span class="line">  8 threadCount, READ,        5811977,   32289,   32289,   32289,     0.2,     0.2,     0.3,     0.3,     0.4,   121.8,  180.0,  0.00108,      0,     13,    1103,    1103,      13,  113422</span><br><span class="line"> 16 threadCount, READ,        8852062,   49178,   49178,   49178,     0.3,     0.3,     0.4,     0.4,     0.5,    63.2,  180.0,  0.00176,      0,     17,     956,     956,       4,  149556</span><br><span class="line"> 24 threadCount, READ,       10255674,   56976,   56976,   56976,     0.4,     0.4,     0.5,     0.6,     0.7,    58.2,  180.0,  0.00189,      0,     11,     541,     541,       1,   96735</span><br><span class="line"> 36 threadCount, READ,       13003446,   72241,   72241,   72241,     0.5,     0.5,     0.6,     0.7,     0.8,    49.9,  180.0,  0.00082,      0,     13,     616,     616,       0,  114296</span><br><span class="line"> 54 threadCount, READ,       15887097,   88261,   88261,   88261,     0.6,     0.6,     0.7,     0.8,     1.0,   107.7,  180.0,  0.00110,      0,     17,     794,     794,       0,  149463</span><br><span class="line"> 81 threadCount, READ,       17262985,   95904,   95904,   95904,     0.8,     0.7,     1.0,     1.0,     1.2,   923.2,  180.0,  0.00918,      0,     18,     843,     843,       1,  158255</span><br><span class="line">121 threadCount, READ,       21136848,  117427,  117427,  117427,     1.0,     0.9,     1.2,     1.4,     1.6,   977.7,  180.0,  0.01099,      0,     23,    1070,    1070,       1,  202215</span><br><span class="line">181 threadCount, READ,       24958916,  138650,  138650,  138650,     1.3,     1.2,     1.6,     2.0,     2.3,   203.5,  180.0,  0.00150,      0,     26,    1198,    1198,       0,  228591</span><br><span class="line">271 threadCount, READ,       21354485,  118630,  118630,  118630,     2.3,     1.8,     2.9,     3.2,     3.7,   911.6,  180.0,  0.01007,      0,     22,    1016,    1016,       0,  193423</span><br><span class="line">406 threadCount, READ,       21890345,  121606,  121606,  121606,     3.3,     3.3,     4.5,     4.9,     5.9,   286.9,  180.0,  0.00107,      0,     23,    1060,    1060,       0,  202215</span><br><span class="line">609 threadCount, READ,       20206343,  112250,  112250,  112250,     5.4,     5.4,     6.9,     7.3,    16.5,    77.0,  180.0,  0.00111,      0,     22,    1020,    1020,       0,  193374</span><br></pre></td></tr></table></figure>
<p>G1_24G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,        3776268,   20979,   20979,   20979,     0.2,     0.2,     0.2,     0.2,     0.3,    62.2,  180.0,  0.00140,      0,      2,     121,     121,       1,   29133</span><br><span class="line">  8 threadCount, READ,        5840032,   32445,   32445,   32445,     0.2,     0.2,     0.3,     0.3,     0.4,    63.1,  180.0,  0.00112,      0,      3,     182,     182,       1,   43696</span><br><span class="line"> 16 threadCount, READ,        8924201,   49579,   49579,   49579,     0.3,     0.3,     0.4,     0.5,     0.5,    63.3,  180.0,  0.00176,      0,      4,     246,     246,       1,   58256</span><br><span class="line"> 24 threadCount, READ,       10387219,   57707,   57707,   57707,     0.4,     0.4,     0.5,     0.6,     0.7,    87.3,  180.0,  0.00197,      0,      5,     297,     297,      20,   72872</span><br><span class="line"> 36 threadCount, READ,       12901814,   71676,   71676,   71676,     0.5,     0.5,     0.6,     0.6,     0.7,    19.5,  180.0,  0.00079,      0,      6,      91,      91,       1,   88381</span><br><span class="line"> 54 threadCount, READ,       15457962,   85876,   85876,   85876,     0.6,     0.6,     0.8,     0.8,     0.9,   142.2,  180.0,  0.00079,      0,      7,      82,      82,       1,  103152</span><br><span class="line"> 81 threadCount, READ,       16689834,   92720,   92720,   92720,     0.9,     0.8,     1.0,     1.1,     1.2,  1028.4,  180.0,  0.01156,      0,      8,      87,      87,       0,  117888</span><br><span class="line">121 threadCount, READ,       23132477,  128511,  128511,  128511,     0.9,     0.9,     1.3,     1.4,     1.7,    20.0,  180.0,  0.00100,      0,     11,     121,     121,       0,  162096</span><br><span class="line">181 threadCount, READ,       24764144,  137574,  137574,  137574,     1.3,     1.2,     1.7,     2.0,     2.3,    24.9,  180.0,  0.00079,      0,     11,     121,     121,       0,  162096</span><br><span class="line">271 threadCount, READ,       21903620,  121680,  121680,  121680,     2.2,     1.8,     2.8,     3.1,     3.6,   929.1,  180.0,  0.01170,      0,     10,     111,     111,       0,  147360</span><br><span class="line">406 threadCount, READ,       20649352,  114685,  114685,  114685,     3.5,     2.9,     4.3,     4.7,     5.5,   923.6,  180.1,  0.01094,      0,     10,     112,     112,       0,  147360</span><br></pre></td></tr></table></figure>
<p>G1_32G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,        3612926,   20072,   20072,   20072,     0.2,     0.2,     0.2,     0.3,     0.3,    67.7,  180.0,  0.00157,      0,      2,     132,     132,       0,   38800</span><br><span class="line">  8 threadCount, READ,        5744438,   31914,   31914,   31914,     0.2,     0.2,     0.3,     0.3,     0.3,    67.9,  180.0,  0.00106,      0,      4,     263,     263,       1,   77536</span><br><span class="line"> 16 threadCount, READ,        8824045,   49022,   49022,   49022,     0.3,     0.3,     0.4,     0.4,     0.5,    69.4,  180.0,  0.00145,      0,      4,     264,     264,       1,   77492</span><br><span class="line"> 24 threadCount, READ,        9937324,   55207,   55207,   55207,     0.4,     0.4,     0.6,     0.6,     0.7,    94.4,  180.0,  0.00163,      0,      6,     284,     284,      28,  116877</span><br><span class="line"> 36 threadCount, READ,       13117518,   72873,   72873,   72873,     0.5,     0.5,     0.6,     0.6,     0.7,    20.0,  180.0,  0.00073,      0,      6,      79,      79,       2,  117790</span><br><span class="line"> 54 threadCount, READ,       15457163,   85872,   85872,   85872,     0.6,     0.6,     0.8,     0.8,     0.9,   128.8,  180.0,  0.00117,      0,      8,      85,      85,       1,  157056</span><br><span class="line"> 81 threadCount, READ,       16216625,   90090,   90090,   90090,     0.9,     0.8,     1.0,     1.1,     1.2,  1069.8,  180.0,  0.00725,      0,      9,      94,      94,       0,  176688</span><br><span class="line">121 threadCount, READ,       22825729,  126807,  126807,  126807,     0.9,     0.9,     1.3,     1.4,     1.6,   959.0,  180.0,  0.00100,      0,     12,     129,     129,       0,  235584</span><br><span class="line">181 threadCount, READ,       24977336,  138758,  138758,  138758,     1.3,     1.2,     1.6,     1.9,     2.3,    29.0,  180.0,  0.00089,      0,     12,     128,     128,       0,  235584</span><br><span class="line">271 threadCount, READ,       22096073,  122749,  122749,  122749,     2.2,     1.8,     2.8,     3.2,     3.7,   839.5,  180.0,  0.01227,      0,     12,     129,     129,       0,  235584</span><br><span class="line">406 threadCount, READ,       22520223,  125103,  125103,  125103,     3.2,     3.1,     4.2,     4.7,     5.3,   136.5,  180.0,  0.00141,      0,     11,     119,     119,       0,  215952</span><br></pre></td></tr></table></figure>
<h4 id="混合模式读大于写">混合模式读大于写</h4><p>./cassandra-stress mixed ratio(write=1,read=3) n=100000 cl=ONE -pop dist=UNIFORM(1..1000000) \<br>-schema keyspace=”keyspace1” -mode native cql3 -rate threads>=16 threads\&lt;=256 -log file=SINGLENODE6_mixed_autorate_50r50w_1M.log -node 10.21.21.10</p>
<p>population=10万，其中读和写的比例是3:1，比如读7万条，写2万条，这种是读比较多的场景。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line"> 16 threadCount, READ,          75251,   34505,   34505,   34505,     0.3,     0.3,     0.4,     0.5,     0.7,    46.8,    2.2,  0.03844,      0,      1,      45,      45,       0,    1712</span><br><span class="line"> 16 threadCount, WRITE,         24749,   11348,   11348,   11348,     0.3,     0.3,     0.4,     0.5,     0.8,    46.7,    2.2,  0.03844,      0,      1,      45,      45,       0,    1712</span><br><span class="line"> 16 threadCount, total,        100000,   45853,   45853,   45853,     0.3,     0.3,     0.4,     0.5,     0.8,    46.8,    2.2,  0.03844,      0,      1,      45,      45,       0,    1712</span><br><span class="line"> 24 threadCount, READ,          74844,   40916,   40916,   40916,     0.4,     0.4,     0.5,     0.6,     0.8,    62.0,    1.8,  0.03023,      0,      1,      60,      60,       0,    1602</span><br><span class="line"> 24 threadCount, WRITE,         25156,   13754,   13754,   13754,     0.4,     0.4,     0.5,     0.6,     0.9,    62.0,    1.8,  0.03023,      0,      1,      60,      60,       0,    1602</span><br><span class="line"> 24 threadCount, total,        100000,   54668,   54668,   54668,     0.4,     0.4,     0.5,     0.6,     0.7,    62.0,    1.8,  0.03023,      0,      1,      60,      60,       0,    1602</span><br><span class="line"> 36 threadCount, READ,          74519,   54694,   54694,   54694,     0.5,     0.5,     0.6,     0.7,     1.6,     3.6,    1.4,  0.00051,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, WRITE,         25481,   18702,   18702,   18702,     0.5,     0.5,     0.6,     0.7,     1.7,     3.6,    1.4,  0.00051,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, total,        100000,   73396,   73396,   73396,     0.5,     0.5,     0.6,     0.7,     1.5,     3.6,    1.4,  0.00051,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, READ,          75429,   62268,   62268,   62268,     0.6,     0.6,     0.8,     1.0,     3.8,    51.4,    1.2,  0.00555,      0,      1,      49,      49,       0,    1621</span><br><span class="line"> 54 threadCount, WRITE,         24571,   20284,   20284,   20284,     0.6,     0.6,     0.8,     1.0,    25.6,    51.3,    1.2,  0.00555,      0,      1,      49,      49,       0,    1621</span><br><span class="line"> 54 threadCount, total,        100000,   82551,   82551,   82551,     0.6,     0.6,     0.8,     1.0,     7.2,    51.4,    1.2,  0.00555,      0,      1,      49,      49,       0,    1621</span><br><span class="line"> 81 threadCount, READ,          74648,   77082,   77082,   77082,     0.8,     0.7,     1.0,     1.2,     2.5,    51.3,    1.0,  0.00000,      0,      1,      48,      48,       0,    1606</span><br><span class="line"> 81 threadCount, WRITE,         25352,   26181,   26181,   26181,     0.8,     0.7,     1.0,     1.2,     3.4,    51.2,    1.0,  0.00000,      0,      1,      48,      48,       0,    1606</span><br><span class="line"> 81 threadCount, total,        100000,  103261,  103261,  103261,     0.8,     0.7,     1.0,     1.2,     2.4,    51.3,    1.0,  0.00000,      0,      1,      48,      48,       0,    1606</span><br><span class="line">121 threadCount, READ,          74735,   85846,   85846,   85846,     1.0,     0.9,     1.1,     1.3,     2.5,    54.0,    0.9,  0.00000,      0,      1,      51,      51,       0,    1609</span><br><span class="line">121 threadCount, WRITE,         25265,   29358,   29358,   29358,     1.0,     0.8,     1.2,     1.4,    53.6,    53.9,    0.9,  0.00000,      0,      1,      51,      51,       0,    1609</span><br><span class="line">121 threadCount, total,        100000,  114867,  114867,  114867,     1.0,     0.9,     1.1,     1.3,     2.4,    54.0,    0.9,  0.00000,      0,      1,      51,      51,       0,    1609</span><br><span class="line">181 threadCount, READ,          74534,  104771,  104771,  104771,     1.3,     1.3,     1.7,     1.9,     5.3,     7.7,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, WRITE,         25466,   35798,   35798,   35798,     1.3,     1.2,     1.7,     2.0,     4.9,     8.3,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, total,        100000,  140568,  140568,  140568,     1.3,     1.2,     1.7,     1.9,     5.1,     8.3,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line"> 16 threadCount, READ,          75381,   34242,   34242,   34242,     0.3,     0.3,     0.4,     0.5,     0.7,    18.8,    2.2,  0.00397,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 16 threadCount, WRITE,         24619,   11183,   11183,   11183,     0.3,     0.3,     0.4,     0.5,     0.8,    18.8,    2.2,  0.00397,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 16 threadCount, total,        100000,   45425,   45425,   45425,     0.3,     0.3,     0.4,     0.5,     0.7,    18.8,    2.2,  0.00397,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, READ,          74898,   42757,   42757,   42757,     0.4,     0.4,     0.5,     0.6,     0.8,    17.6,    1.8,  0.02794,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, WRITE,         25102,   14331,   14331,   14331,     0.4,     0.4,     0.5,     0.6,     0.9,    17.6,    1.8,  0.02794,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, total,        100000,   57087,   57087,   57087,     0.4,     0.4,     0.5,     0.6,     0.8,    17.6,    1.8,  0.02794,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, READ,          75189,   54221,   54221,   54221,     0.5,     0.5,     0.6,     0.7,     1.7,     8.3,    1.4,  0.00024,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, WRITE,         24811,   17892,   17892,   17892,     0.5,     0.5,     0.6,     0.7,     1.7,     5.2,    1.4,  0.00024,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, total,        100000,   72113,   72113,   72113,     0.5,     0.5,     0.6,     0.7,     1.7,     8.3,    1.4,  0.00024,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, READ,          74941,   63319,   63319,   63319,     0.6,     0.6,     0.8,     1.0,     1.5,    24.7,    1.2,  0.02843,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, WRITE,         25059,   21175,   21175,   21175,     0.6,     0.6,     0.8,     1.0,     2.0,    24.5,    1.2,  0.02843,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, total,        100000,   84492,   84492,   84492,     0.6,     0.6,     0.8,     1.0,     1.4,    24.7,    1.2,  0.02843,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, READ,          75009,   80336,   80336,   80336,     0.7,     0.7,     1.0,     1.0,     1.1,     7.2,    0.9,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, WRITE,         24991,   26766,   26766,   26766,     0.7,     0.7,     1.0,     1.1,     1.3,     3.1,    0.9,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, total,        100000,  107102,  107102,  107102,     0.7,     0.7,     1.0,     1.0,     1.1,     7.2,    0.9,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, READ,          75063,   91080,   91080,   91080,     1.0,     0.9,     1.3,     1.5,     3.2,    29.6,    0.8,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, WRITE,         24937,   30259,   30259,   30259,     1.0,     0.9,     1.3,     1.7,    28.2,    29.6,    0.8,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, total,        100000,  121338,  121338,  121338,     1.0,     0.9,     1.3,     1.5,    13.5,    29.6,    0.8,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, READ,          75342,  104114,  104114,  104114,     1.3,     1.3,     1.7,     1.9,     3.9,     7.6,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, WRITE,         24658,   34075,   34075,   34075,     1.3,     1.3,     1.7,     2.0,     4.9,     8.0,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, total,        100000,  138189,  138189,  138189,     1.3,     1.3,     1.7,     1.9,     3.3,     8.0,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<p>G1_24G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> 16 threadCount, READ,          74594,   33655,   33655,   33655,     0.3,     0.3,     0.5,     0.5,     0.8,    23.1,    2.2,  0.00911,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 16 threadCount, WRITE,         25406,   11467,   11467,   11467,     0.3,     0.3,     0.5,     0.5,     0.8,     9.9,    2.2,  0.00911,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 16 threadCount, total,        100000,   45117,   45117,   45117,     0.3,     0.3,     0.5,     0.5,     0.8,    23.1,    2.2,  0.00911,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, READ,          74649,   40798,   40798,   40798,     0.4,     0.4,     0.5,     0.6,     0.7,    13.7,    1.8,  0.01581,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, WRITE,         25351,   13861,   13861,   13861,     0.4,     0.4,     0.5,     0.6,     0.7,    13.7,    1.8,  0.01581,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, total,        100000,   54653,   54653,   54653,     0.4,     0.4,     0.5,     0.6,     0.7,    13.7,    1.8,  0.01581,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, READ,          75378,   53898,   53898,   53898,     0.5,     0.5,     0.6,     0.7,     1.6,     3.2,    1.4,  0.01693,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, WRITE,         24622,   17606,   17606,   17606,     0.5,     0.5,     0.6,     0.7,     1.4,     2.9,    1.4,  0.01693,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, total,        100000,   71503,   71503,   71503,     0.5,     0.5,     0.6,     0.7,     1.4,     3.2,    1.4,  0.01693,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, READ,          75012,   61606,   61606,   61606,     0.6,     0.6,     0.8,     1.0,     3.1,    30.7,    1.2,  0.02550,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, WRITE,         24988,   20522,   20522,   20522,     0.6,     0.6,     0.8,     1.0,     3.8,    30.5,    1.2,  0.02550,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, total,        100000,   82128,   82128,   82128,     0.6,     0.6,     0.8,     1.0,     3.4,    30.7,    1.2,  0.02550,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, READ,          75469,   76118,   76118,   76118,     0.8,     0.8,     1.0,     1.1,     1.3,     3.0,    1.0,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, WRITE,         24531,   24748,   24748,   24748,     0.8,     0.8,     1.0,     1.1,     1.6,     2.6,    1.0,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, total,        100000,  100860,  100860,  100860,     0.8,     0.8,     1.0,     1.1,     1.3,     3.0,    1.0,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, READ,          75006,   90799,   90799,   90799,     1.0,     0.9,     1.3,     1.5,    31.1,    31.5,    0.8,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, WRITE,         24994,   30257,   30257,   30257,     1.0,     0.9,     1.3,     1.5,    31.3,    31.5,    0.8,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, total,        100000,  121055,  121055,  121055,     1.0,     0.9,     1.3,     1.5,     5.5,    31.5,    0.8,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, READ,          75454,  103545,  103545,  103545,     1.3,     1.3,     1.7,     2.0,     2.2,     4.5,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, WRITE,         24546,   33685,   33685,   33685,     1.3,     1.3,     1.8,     2.1,     3.0,     4.5,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, total,        100000,  137229,  137229,  137229,     1.3,     1.3,     1.7,     2.0,     2.2,     4.5,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<h4 id="混合模式写大于读">混合模式写大于读</h4><p>./cassandra-stress mixed ratio(write=3,read=1) n=1000000 cl=ONE -pop dist=UNIFORM(1..10000000) -schema keyspace=”keyspace1” -mode native cql3 -rate threads>=16 threads\&lt;=256 -log file=SINGLENODE6_mixed_write3read1_1M.log -node 10.21.21.10</p>
<h3 id="自定义schema">自定义schema</h3><p><a href="http://www.datastax.com/dev/blog/improved-cassandra-2-1-stress-tool-benchmark-any-schema" target="_blank" rel="noopener">http://www.datastax.com/dev/blog/improved-cassandra-2-1-stress-tool-benchmark-any-schema</a></p>
<p>自定义的YAML配置文件包括四部分：  </p>
<ol>
<li>DDL：表结构</li>
<li>列的分布：定义每个列的大小，和每个Partition有多少列等</li>
<li>写入数据的分布：数据写入</li>
<li>DML：数据查询</li>
</ol>
<blockquote>
<p>模拟数据一般考虑生成多少行（总的数据量和每行的数据量），每一列的数据大小和数据分布。</p>
</blockquote>
<p><strong>列分布</strong>是为了模拟实际的数据：model the size of the data in the column, the number of unique values, and the clustering of them withing a given partition.<br>分别对应了columnspec下每个column的size，population,cluster。当然并不是说每个列都要定义这三个选项，只有排序键cluster key才需要定义cluster（比如下文的publish_date）。  </p>
<ul>
<li>Size distribution – Defines the distribution of sizes for text, blob, set and list types  (default of UNIFORM(4..8))</li>
<li>Population distribution – Defines the distribution of <strong>unique values for the column values</strong> (default of UNIFORM(1..100B))</li>
<li>Cluster distribution – Defines the  distribution for <strong>the number of clustering prefixes within a given partition</strong> (default of FIXED(1))</li>
</ul>
<blockquote>
<p>B是Billion十亿,默认值100B=1000亿，M是Million百万。UNIFORM:均匀分布/平均分布，Gaussion:高斯分布/正太分布，中间高两边低<br>默认的size，population，cluster表示：长度=[4,8]均匀分布，数据量=[1,1000万]均匀分布，排序键=1，表示每一个主键只有一行数据。  </p>
</blockquote>
<p>size表示每一列的长度（比如默认每一列长度在4-8之间），population表示不同列的数量，比如n=10万，population=1000，表示在产生10万条数据，但是不同的数据只有1000条，也就是每条数据实际上有多个列。不过为什么UNIFORM(1..100B)是个范围而不是精确的数字呢？比如n=10万，而UNIFORM(1..100B)，其中最大值100B=1000亿，那么数据是怎么分布的呢？  </p>
<p><strong>插入分布</strong>：插入数据要指定row-key，对应Cassandra的Partition这个概念，每一行row-key都对应了一个Partition。 批量插入数据的方式有LOGGED和UNLOGGED两种类型。</p>
<ul>
<li>Partition distribution：The number of partitions to update per batch (default FIXED(1))</li>
<li>select distribution ratio：The ratio of rows each partition should insert as a proportion of the total possible rows for the partition (as defined by the clustering distribution columns). default FIXED(1)/1</li>
</ul>
<blockquote>
<p>列分布决定数据的分布，插入分布决定插入的方式。可以不需要配置插入分布，插入数据时会自动符合列分布。</p>
</blockquote>
<h4 id="示例">示例</h4><blockquote>
<p>说明：在tools/bin下创建blogpost1.yaml配置文件。如果表结果已经存在，只需要定义keyspace和table就可以，<br>不需要定义keyspace_definition和table_definition。由于目前还是单节点测试，所以副本数=1。  </p>
</blockquote>
<p>表结构说明： blogposts存储博客，主键是domain，排序键是发布时间。在实际中domain是实际的站点，url是博客的链接地址。<br>比如domain=<a href="http://blog.csdn.net" target="_blank" rel="noopener">http://blog.csdn.net</a>，在同一个站点发布博客的所有作者都放在同一行。这种一般用于现在非常流畅的聚合类应用。  </p>
<blockquote>
<p>目标：define a model for a simple app to hold blog posts for multiple websites 多个站点的帖子</p>
</blockquote>
<p>而如果对于某个博客站点自己做的应用他不需要聚合其他站点的博客，就可以把domain理解成博客作者的主页。<br>比如我在CSDN博客于2015-01-27发表了一篇关于Hello Flink的入门文章：  </p>
<p>domain：<a href="http://blog.csdn.net/zqhxuyuan" target="_blank" rel="noopener">http://blog.csdn.net/zqhxuyuan</a><br>publish-date：2015-01-27<br>url: <a href="http://blog.csdn.net/zqhxuyuan/article/details/43196423" target="_blank" rel="noopener">http://blog.csdn.net/zqhxuyuan/article/details/43196423</a>  </p>
<p>又在2016-05-18发表了一篇Apache GraphX的图文详解文章：  </p>
<p>domain：<a href="http://blog.csdn.net/zqhxuyuan" target="_blank" rel="noopener">http://blog.csdn.net/zqhxuyuan</a><br>publish-date：2016-05-18<br>url：<a href="http://blog.csdn.net/zqhxuyuan/article/details/48730515" target="_blank" rel="noopener">http://blog.csdn.net/zqhxuyuan/article/details/48730515</a>  </p>
<p>在Cassandra相同key的不同记录以列式存储，实际存储结果类似：  </p>
<table>
<thead>
<tr>
<th>row-key</th>
<th>2015-01-27:url:author:title:body</th>
<th>2016-05-18:url:author:title:body</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://blog.csdn.net/zqhxuyuan" target="_blank" rel="noopener">http://blog.csdn.net/zqhxuyuan</a></td>
<td><a href="http://blog.csdn.net/zqhxuyuan/article/details/43196423" target="_blank" rel="noopener">http://blog.csdn.net/zqhxuyuan/article/details/43196423</a>:zqhxuyuan:Hello Flink:…</td>
<td><a href="http://blog.csdn.net/zqhxuyuan/article/details/48730515" target="_blank" rel="noopener">http://blog.csdn.net/zqhxuyuan/article/details/48730515</a>:zqhxuyuan:Apache GraphX 图文详解:…</td>
</tr>
</tbody>
</table>
<blockquote>
<p>集群环境下，可以修改副本数=3，不过可以先测试1个副本，然后再测试3个副本</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### DDL ###</span></span><br><span class="line"><span class="comment">###########</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Keyspace Name</span></span><br><span class="line"><span class="attr">keyspace:</span> <span class="string">stresscql</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The CQL for creating a keyspace (optional if it already exists)</span></span><br><span class="line"><span class="attr">keyspace_definition:</span> <span class="string">|</span></span><br><span class="line"><span class="string">  CREATE KEYSPACE stresscql WITH replication = &#123;'class': 'SimpleStrategy', 'replication_factor': 1&#125;;</span></span><br><span class="line"><span class="string"># Table name</span></span><br><span class="line"><span class="string"></span><span class="attr">table:</span> <span class="string">blogposts</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The CQL for creating a table you wish to stress (optional if it already exists)</span></span><br><span class="line"><span class="attr">table_definition:</span> <span class="string">|</span></span><br><span class="line"><span class="string">  CREATE TABLE blogposts (</span></span><br><span class="line"><span class="string">        domain text,</span></span><br><span class="line"><span class="string">        published_date timeuuid,</span></span><br><span class="line"><span class="string">        url text,</span></span><br><span class="line"><span class="string">        author text,</span></span><br><span class="line"><span class="string">        title text,</span></span><br><span class="line"><span class="string">        body text,</span></span><br><span class="line"><span class="string">        PRIMARY KEY(domain, published_date)</span></span><br><span class="line"><span class="string">  ) WITH CLUSTERING ORDER BY (published_date DESC) </span></span><br><span class="line"><span class="string">    AND compaction = &#123; 'class':'LeveledCompactionStrategy' &#125; </span></span><br><span class="line"><span class="string">    AND comment='A table to hold blog posts'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### Column Distribution Specifications ###</span></span><br><span class="line"><span class="string">##########################################</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span><span class="attr">columnspec:</span></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">domain</span></span><br><span class="line"><span class="attr">    size:</span> <span class="string">gaussian(5..100)</span>       <span class="comment">#domain names are relatively short</span></span><br><span class="line"><span class="attr">    population:</span> <span class="string">uniform(1..10M)</span>  <span class="comment">#10M possible domains to pick from</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">published_date</span>         <span class="comment">#每个站点最多允许1000个帖子，用排序键决定列的数量</span></span><br><span class="line"><span class="attr">    cluster:</span> <span class="string">fixed(1000)</span>         <span class="comment">#under each domain we will have max 1000 posts</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">url</span></span><br><span class="line"><span class="attr">    size:</span> <span class="string">uniform(30..300)</span>       </span><br><span class="line"></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">title</span>                  <span class="comment">#titles shouldn't go beyond 200 chars</span></span><br><span class="line"><span class="attr">    size:</span> <span class="string">gaussian(10..200)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">author</span></span><br><span class="line"><span class="attr">    size:</span> <span class="string">uniform(5..20)</span>         <span class="comment">#author names should be short</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">body</span></span><br><span class="line"><span class="attr">    size:</span> <span class="string">gaussian(100..5000)</span>    <span class="comment">#the body of the blog post can be long</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">### Batch Ratio Distribution Specifications ###</span></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line"></span><br><span class="line"><span class="attr">insert:</span>                           <span class="comment">#每个batch只插入一次（？）， 比如可以用insert=1，或者insert=2，...</span></span><br><span class="line"><span class="attr">  partitions:</span> <span class="string">fixed(1)</span>            <span class="comment">#Our partition key is the domain so only insert one per batch</span></span><br><span class="line"><span class="attr">  select:</span>    <span class="string">fixed(1)/1000</span>        <span class="comment">#We have 1000 posts per domain so 1/1000 will allow 1 post per batch</span></span><br><span class="line"><span class="attr">  batchtype:</span> <span class="string">UNLOGGED</span>             <span class="comment">#Unlogged batches</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### A list of queries you wish to run against the schema ###</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"></span><br><span class="line"><span class="attr">queries:</span></span><br><span class="line"><span class="attr">   singlepost:</span></span><br><span class="line"><span class="attr">      cql:</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">blogposts</span> <span class="string">where</span> <span class="string">domain</span> <span class="string">=</span> <span class="string">?</span> <span class="string">LIMIT</span> <span class="number">1</span> </span><br><span class="line"><span class="attr">      fields:</span> <span class="string">samerow</span></span><br><span class="line"><span class="attr">   timeline:</span> </span><br><span class="line"><span class="attr">      cql:</span> <span class="string">select</span> <span class="string">url,</span> <span class="string">title,</span> <span class="string">published_date</span> <span class="string">from</span> <span class="string">blogposts</span> <span class="string">where</span> <span class="string">domain</span> <span class="string">=</span> <span class="string">?</span> <span class="string">LIMIT</span> <span class="number">10</span></span><br><span class="line"><span class="attr">      fields:</span> <span class="string">samerow</span></span><br></pre></td></tr></table></figure>
<p>数据分布测试：</p>
<p>./cassandra-stress user profile=blogpost.yaml ops(insert=1) -rate threads=100 -node 10.21.21.130</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  domain text,</span><br><span class="line">  published_date timeuuid,</span><br><span class="line"></span><br><span class="line">columspec:</span><br><span class="line">  - name: domain</span><br><span class="line">    size: gaussian(5..20)       </span><br><span class="line">    population: uniform(1..100)  </span><br><span class="line"></span><br><span class="line">  - name: published_date         </span><br><span class="line">    cluster: fixed(10)</span><br></pre></td></tr></table></figure>
<p>数据特征：总数=1000条，<strong>相同domain不同published_date有10条</strong>。 <strong>domain一共有100条</strong>，所以总数=100*10=1000<br>字段的长度和类型也有关系，比如published_date是uuid类型，长度是固定的，即使指定size也不起作用。<br>而domain和autor为文本类型，支持size的分布方式，比如domain是高斯分布，5-20中间的部分12左右最多。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[admin@cass021133 bin]$ cqlsh 10.21.21.130 -e &quot;select domain,published_date,author from stresscql.blogposts1;&quot;</span><br><span class="line">...</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | 29124890-da3b-11d9-4eb1-f78328592aad |                |\x15\x0b\x17\x15-\x1cE\x1bYY\x1a</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | 70758610-c81c-11d9-4eb1-f78328592aad |                                n4Q\x05\x02P\x1e0</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | ce7cac90-9d72-11d9-4eb1-f78328592aad |                                   \x07\x18\x0ew[</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | 262528f0-ddf2-11d3-4eb1-f78328592aad |                                         .x[ChI+&#125;</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | c5e60070-55de-11d0-4eb1-f78328592aad |                            p;.\x12\nKn[N-\x17^tc</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | db0601c0-cb63-11c2-4eb1-f78328592aad |              z$y\x06$v+DwMqsA\x00=\x08/3\x12\x1b</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | 7b715db0-857b-11bc-4eb1-f78328592aad |          \x1138\x15\x1e2\x13`\x19/@9M\x00\x088;</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | ac53f6d0-254b-11bc-4eb1-f78328592aad |                   )\x0f\x14MWKc7t\x01qv]JZ[\x19~</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | 468457e0-829e-11b7-4eb1-f78328592aad |                  7\x02%\tn=y\x00\x19/M\x15\x1e&quot;E</span><br><span class="line">               ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R | 20466680-2370-11b4-4eb1-f78328592aad |                       &gt;_u&#125;x\x1cSFu\x0e)\x1ey\x10</span><br><span class="line">(1000 rows)</span><br><span class="line"></span><br><span class="line">[admin@cass021133 bin]$ cqlsh 10.21.21.130 -e &quot;select distinct domain from stresscql.blogposts1;&quot;</span><br><span class="line">                \x05!GRpp\x1dD\x1fuUpS</span><br><span class="line">                      srP&#125;.6R\x1c&quot;xd)t</span><br><span class="line">                      Mw&#125;o^\x16zFQ -!y</span><br><span class="line">              ;&quot;&#123;(\x06\x17&#125;N\x01Y-ic:R</span><br><span class="line">(100 rows)</span><br></pre></td></tr></table></figure>
<h4 id="只有写入">只有写入</h4><p>./cassandra-stress user profile=./blogpost1.yaml ops(insert=1) -node 10.21.21.10 -log file=SINGLENODE7_blog_insert.log</p>
<p>默认没有其他选项，会从4个线程开始，并逐步增加线程数量，直到达到一个限制。默认的插入模式协议采用native transport，以及使用PreparedStatement。<br>这里跟标准测试不同的是，没有指定n=?，因为在profile YAML配置文件中，insert部分已经可以说明数据将如何被插入。  </p>
<blockquote>
<p>参考文章中作者的笔记本单台机器，可以达到401个线程，每秒8500。下面的测试结果中线程的上限只有81个，不过每秒可以写入2.5万条记录。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">            id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line"> 4 threadCount, insert,       244201,    8098,    8098,   11068,     0.4,     0.4,     0.6,     0.7,     1.0,   380.9,   30.2,  0.00348,      0,      4,    1207,    1207,      53,    5233</span><br><span class="line"> 8 threadCount, insert,       429876,   14162,   14162,   19369,     0.5,     0.4,     0.7,     0.8,     1.4,   265.7,   30.4,  0.01082,      0,      7,    1606,    1606,      20,    9419</span><br><span class="line">16 threadCount, insert,       658771,   21750,   21750,   29780,     0.6,     0.5,     0.8,     1.0,     2.2,   279.1,   30.3,  0.00910,      0,     12,    2182,    2266,      59,   16897</span><br><span class="line">24 threadCount, insert,       754842,   24767,   24767,   33897,     0.8,     0.7,     1.0,     1.5,     4.5,   232.1,   30.5,  0.01926,      0,     13,    2256,    2256,      46,   19254</span><br><span class="line">36 threadCount, insert,       768148,   25357,   25357,   34689,     1.3,     1.1,     1.5,     2.0,     3.9,   238.5,   30.3,  0.01159,      0,     13,    2095,    2185,      39,   19013</span><br><span class="line">54 threadCount, insert,       761943,   25102,   25102,   34326,     2.0,     1.7,     2.1,     2.7,    25.4,   263.5,   30.4,  0.01724,      0,     13,    2076,    2152,      38,   19154</span><br><span class="line">81 threadCount, insert,       755494,   24711,   24711,   33815,     3.2,     2.7,     3.1,     4.1,   148.3,   270.2,   30.6,  0.01210,      0,     13,    2227,    2227,      48,   19182</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,       251178,    8245,    8245,   11278,     0.4,     0.4,     0.6,     0.7,     1.0,   274.2,   30.5,  0.00551,      0,      4,     902,     902,      43,    5347</span><br><span class="line">  8 threadCount, insert,       427090,   13995,   13995,   19119,     0.5,     0.4,     0.7,     0.8,     1.6,   235.4,   30.5,  0.00936,      0,      9,    1557,    1557,      46,   13130</span><br><span class="line"> 16 threadCount, insert,       677353,   22261,   22261,   30444,     0.6,     0.5,     0.8,     1.1,     2.2,   239.3,   30.4,  0.00837,      0,     11,    2080,    2080,      40,   14631</span><br><span class="line"> 24 threadCount, insert,       762573,   24999,   24999,   34192,     0.8,     0.7,     1.0,     1.2,     2.0,   246.0,   30.5,  0.00974,      0,     12,    2131,    2131,      38,   15912</span><br><span class="line"> 36 threadCount, insert,       772075,   25215,   25215,   34509,     1.3,     1.1,     1.5,     2.3,     6.4,   250.1,   30.6,  0.00550,      0,     12,    2149,    2149,      31,   15900</span><br><span class="line"> 54 threadCount, insert,       780249,   25669,   25669,   35082,     2.0,     1.7,     2.1,     2.6,    22.5,   279.1,   30.4,  0.00497,      0,     12,    2358,    2358,      24,   15793</span><br><span class="line"> 81 threadCount, insert,       781505,   25519,   25519,   34884,     3.0,     2.7,     3.1,     4.1,   173.6,   310.7,   30.6,  0.01380,      0,     13,    2137,    2137,      37,   18920</span><br><span class="line">121 threadCount, insert,       770318,   25009,   25009,   34189,     4.7,     4.0,     4.5,     5.4,   185.7,   277.4,   30.8,  0.01570,      0,     12,    2152,    2152,      36,   15916</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,       248881,    8178,    8178,   11171,     0.4,     0.4,     0.6,     0.7,     1.1,   373.4,   30.4,  0.01796,      0,      2,     704,     704,      11,    5843</span><br><span class="line">  8 threadCount, insert,       446173,   14559,   14559,   19911,     0.5,     0.4,     0.7,     0.8,     1.2,   324.8,   30.6,  0.03065,      0,      2,     532,     532,      57,    7486</span><br><span class="line"> 16 threadCount, insert,       690320,   22697,   22697,   31027,     0.6,     0.5,     0.8,     1.0,     2.1,   335.4,   30.4,  0.00967,      0,      4,     937,     937,      74,   14148</span><br><span class="line"> 24 threadCount, insert,       767142,   25009,   25009,   34198,     0.8,     0.7,     1.0,     1.3,     2.9,   450.4,   30.7,  0.01082,      0,      4,    1506,    1506,      68,   18804</span><br><span class="line"> 36 threadCount, insert,       779673,   25765,   25765,   35240,     1.3,     1.1,     1.5,     2.5,    16.4,   284.5,   30.3,  0.01161,      0,      5,    1062,    1062,      43,   14792</span><br><span class="line"> 54 threadCount, insert,       806073,   25927,   25927,   35449,     2.0,     1.7,     2.2,     2.8,     8.2,   466.0,   31.1,  0.00649,      0,      5,    1667,    1667,      87,   18160</span><br><span class="line"> 81 threadCount, insert,       804974,   26236,   26236,   35850,     3.0,     2.7,     3.1,     3.9,    44.3,   539.6,   30.7,  0.00619,      0,      4,    1155,    1155,     155,   15884</span><br><span class="line">121 threadCount, insert,       767591,   25302,   25302,   34605,     4.7,     4.0,     4.6,     5.4,   111.4,   394.4,   30.3,  0.01340,      0,      6,    1585,    1585,      78,   16745</span><br></pre></td></tr></table></figure>
<p>G1_24G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,       257051,    8524,    8524,   11675,     0.4,     0.3,     0.6,     0.7,     0.9,   224.7,   30.2,  0.00582,      0,      0,       0,       0,       0,       0</span><br><span class="line">  8 threadCount, insert,       450270,   14830,   14830,   20289,     0.4,     0.4,     0.7,     0.8,     1.4,   330.0,   30.4,  0.00674,      0,      1,     327,     327,       0,   13398</span><br><span class="line"> 16 threadCount, insert,       702064,   23078,   23078,   31593,     0.6,     0.5,     0.8,     1.0,     2.0,   401.3,   30.4,  0.00763,      0,      2,     658,     658,      69,   26291</span><br><span class="line"> 24 threadCount, insert,       798352,   26369,   26369,   36088,     0.8,     0.7,     1.0,     1.4,     2.3,   250.0,   30.3,  0.00953,      0,      1,     231,     231,       0,   12944</span><br><span class="line"> 36 threadCount, insert,       824159,   27317,   27317,   37329,     1.2,     1.1,     1.5,     1.9,     3.5,   242.5,   30.2,  0.00507,      0,      2,     248,     248,      44,   27657</span><br><span class="line"> 54 threadCount, insert,       812952,   26948,   26948,   36838,     1.9,     1.7,     2.1,     2.8,     8.7,   235.6,   30.2,  0.00507,      0,      1,     206,     206,       0,   13159</span><br><span class="line"> 81 threadCount, insert,       826216,   27214,   27214,   37200,     2.9,     2.7,     3.1,     4.2,    25.3,   238.6,   30.4,  0.00570,      0,      2,     232,     232,      44,   27827</span><br><span class="line">121 threadCount, insert,       834614,   27495,   27495,   37594,     4.3,     4.0,     4.5,     5.0,    23.9,   263.9,   30.4,  0.00342,      0,      2,     456,     456,      25,   26020</span><br><span class="line">181 threadCount, insert,       795024,   25577,   25577,   34996,     6.9,     6.1,     6.7,     7.7,   113.7,   444.3,   31.1,  0.01847,      0,      1,     429,     429,       0,   11326</span><br></pre></td></tr></table></figure>
<h4 id="读写混合模式">读写混合模式</h4><p>类似于mixed模式指定读和写的线程数，自定义的ops包括insert和多种查询方式，比如blogpost1.yaml的queries定义了两种查询模式。  </p>
<p>./cassandra-stress user profile=./blogpost1.yaml ops(singlepost=2,timeline=1,insert=1) -node 10.21.21.10 -log file=SINGLENODE8_blog_mixed.log</p>
<p>singlepost的查询是timeline查询和insert写入的两倍，比如查询singlepost次数=71309，写入insert=34965，查询timeline=35761。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,        34965,    1118,    1118,    1528,     0.4,     0.4,     0.7,     0.8,     1.5,    56.7,   31.3,  0.00905,      0,      8,     413,     413,      32,   12700</span><br><span class="line">  4 threadCount, singlepost,    71309,    2280,    2166,    2166,     0.9,     1.0,     1.3,     1.4,     2.0,   137.9,   31.3,  0.00905,      0,      8,     413,     413,      32,   12700</span><br><span class="line">  4 threadCount, timeline,      35761,    1143,    1085,    6727,     1.0,     1.0,     1.4,     1.6,     2.1,   138.0,   31.3,  0.00905,      0,      8,     413,     413,      32,   12700</span><br><span class="line">  4 threadCount, total,        142035,    4541,    4368,   10420,     0.8,     0.8,     1.3,     1.4,     1.6,   138.0,   31.3,  0.00905,      0,      8,     413,     413,      32,   12700</span><br><span class="line">  8 threadCount, insert,        67924,    2135,    2135,    2924,     0.5,     0.4,     0.7,     0.9,     3.0,    41.6,   31.8,  0.00592,      0,     13,     477,     477,       2,   20864</span><br><span class="line">  8 threadCount, singlepost,   137283,    4314,    4098,    4098,     0.9,     1.0,     1.3,     1.5,     1.9,    43.1,   31.8,  0.00592,      0,     13,     477,     477,       2,   20864</span><br><span class="line">  8 threadCount, timeline,      68781,    2162,    2052,   12863,     1.1,     1.1,     1.5,     1.7,     2.2,    42.2,   31.8,  0.00592,      0,     13,     477,     477,       2,   20864</span><br><span class="line">  8 threadCount, total,        273988,    8611,    8285,   19885,     0.9,     0.8,     1.4,     1.6,     2.0,    43.1,   31.8,  0.00592,      0,     13,     477,     477,       2,   20864</span><br><span class="line"> 16 threadCount, insert,       120202,    3684,    3684,    5031,     0.6,     0.5,     0.9,     1.1,     1.9,    47.8,   32.6,  0.00506,      0,     22,     872,     872,       3,   35249</span><br><span class="line"> 16 threadCount, singlepost,   238117,    7297,    6947,    6947,     1.1,     1.1,     1.6,     1.9,     4.1,    49.4,   32.6,  0.00506,      0,     22,     872,     872,       3,   35249</span><br><span class="line"> 16 threadCount, timeline,     121167,    3713,    3532,   22654,     1.2,     1.2,     1.8,     2.1,     7.1,    49.0,   32.6,  0.00506,      0,     22,     872,     872,       3,   35249</span><br><span class="line"> 16 threadCount, total,        479486,   14694,   14163,   34631,     1.0,     0.9,     1.6,     1.9,     3.7,    49.4,   32.6,  0.00506,      0,     22,     872,     872,       3,   35249</span><br><span class="line"> 24 threadCount, insert,       155861,    4687,    4687,    6411,     0.7,     0.6,     1.1,     1.8,     7.0,    70.5,   33.3,  0.00541,      0,     29,    1218,    1262,       6,   47967</span><br><span class="line"> 24 threadCount, singlepost,   311426,    9364,    8937,    8937,     1.3,     1.2,     2.0,     2.4,     7.2,    71.7,   33.3,  0.00541,      0,     29,    1218,    1262,       6,   47967</span><br><span class="line"> 24 threadCount, timeline,     156992,    4720,    4502,   29719,     1.5,     1.4,     2.2,     2.6,    42.2,    71.7,   33.3,  0.00541,      0,     29,    1218,    1262,       6,   47967</span><br><span class="line"> 24 threadCount, total,        624279,   18771,   18125,   45066,     1.2,     1.0,     2.0,     2.3,     6.8,    71.7,   33.3,  0.00541,      0,     29,    1218,    1262,       6,   47967</span><br><span class="line"> 36 threadCount, insert,       190266,    5468,    5468,    7489,     1.0,     0.8,     1.9,     2.9,    10.6,   267.7,   34.8,  0.00593,      0,     35,    1226,    1417,       3,   56050</span><br><span class="line"> 36 threadCount, singlepost,   380356,   10930,   10461,   10461,     1.7,     1.5,     2.7,     3.7,    40.5,    57.6,   34.8,  0.00593,      0,     35,    1226,    1417,       3,   56050</span><br><span class="line"> 36 threadCount, timeline,     189548,    5447,    5211,   35642,     1.9,     1.7,     3.0,     4.3,    44.1,    57.1,   34.8,  0.00593,      0,     35,    1226,    1417,       3,   56050</span><br><span class="line"> 36 threadCount, total,        760170,   21844,   21140,   53592,     1.6,     1.3,     2.7,     3.5,     9.4,   267.7,   34.8,  0.00593,      0,     35,    1226,    1417,       3,   56050</span><br><span class="line"> 54 threadCount, insert,       207273,    5642,    5642,    7719,     1.7,     1.2,     3.9,     7.3,    37.8,    56.4,   36.7,  0.00588,      0,     38,    1192,    1503,       2,   60870</span><br><span class="line"> 54 threadCount, singlepost,   416789,   11344,   10897,   10897,     2.4,     2.0,     4.1,     6.7,    42.7,    56.1,   36.7,  0.00588,      0,     38,    1192,    1503,       2,   60870</span><br><span class="line"> 54 threadCount, timeline,     206615,    5624,    5403,   38239,     2.6,     2.3,     4.5,     8.0,    43.6,    55.0,   36.7,  0.00588,      0,     38,    1192,    1503,       2,   60870</span><br><span class="line"> 54 threadCount, total,        830677,   22610,   21942,   56855,     2.3,     1.9,     4.1,     7.1,    42.4,    56.4,   36.7,  0.00588,      0,     38,    1192,    1503,       2,   60870</span><br><span class="line"> 81 threadCount, insert,       224064,    5377,    5377,    7341,     3.2,     2.3,     6.7,    12.7,    50.5,   350.3,   41.7,  0.00879,      0,     44,    1354,    1883,       5,   72225</span><br><span class="line"> 81 threadCount, singlepost,   447717,   10745,   10347,   10347,     3.7,     3.1,     6.4,    11.4,    50.4,   291.2,   41.7,  0.00879,      0,     44,    1354,    1883,       5,   72225</span><br><span class="line"> 81 threadCount, timeline,     224468,    5387,    5188,   37984,     4.0,     3.4,     6.6,    11.3,    50.5,   288.1,   41.7,  0.00879,      0,     44,    1354,    1883,       5,   72225</span><br><span class="line"> 81 threadCount, total,        896249,   21509,   20913,   55672,     3.7,     3.0,     6.4,    10.6,    49.3,   350.3,   41.7,  0.00879,      0,     44,    1354,    1883,       5,   72225</span><br><span class="line">121 threadCount, insert,       260078,    5322,    5322,    7286,     4.9,     3.8,    11.1,    21.4,    54.6,   166.5,   48.9,  0.00509,      0,     51,    1255,    2034,       2,   81759</span><br><span class="line">121 threadCount, singlepost,   525682,   10758,   10398,   10398,     5.6,     4.9,     9.5,    15.4,    50.4,   151.7,   48.9,  0.00509,      0,     51,    1255,    2034,       2,   81759</span><br><span class="line">121 threadCount, timeline,     260886,    5339,    5157,   39078,     5.9,     5.2,     9.9,    17.1,    51.6,   151.7,   48.9,  0.00509,      0,     51,    1255,    2034,       2,   81759</span><br><span class="line">121 threadCount, total,       1046646,   21419,   20877,   56762,     5.5,     4.8,     9.7,    16.0,    50.6,   166.5,   48.9,  0.00509,      0,     51,    1255,    2034,       2,   81759</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,        33438,    1048,    1048,    1436,     0.5,     0.4,     0.7,     0.9,    11.6,   276.4,   31.9,  0.00995,      0,      1,     274,     274,       0,    8124</span><br><span class="line">  4 threadCount, singlepost,    66170,    2074,    2007,    2007,     1.0,     1.0,     1.3,     1.4,     1.8,   277.3,   31.9,  0.00995,      0,      1,     274,     274,       0,    8124</span><br><span class="line">  4 threadCount, timeline,      33241,    1042,    1008,    7133,     1.1,     1.1,     1.5,     1.6,     2.1,    11.0,   31.9,  0.00995,      0,      1,     274,     274,       0,    8124</span><br><span class="line">  4 threadCount, total,        132849,    4164,    4063,   10576,     0.9,     0.9,     1.3,     1.5,     1.9,   277.3,   31.9,  0.00995,      0,      1,     274,     274,       0,    8124</span><br><span class="line">  8 threadCount, insert,        61953,    1927,    1927,    2635,     0.5,     0.4,     0.8,     0.9,    11.2,   235.4,   32.1,  0.02825,      0,      3,     700,     700,       0,   24313</span><br><span class="line">  8 threadCount, singlepost,   124181,    3863,    3742,    3742,     1.1,     1.1,     1.4,     1.5,     2.1,   236.5,   32.1,  0.02825,      0,      3,     700,     700,       0,   24313</span><br><span class="line">  8 threadCount, timeline,      61760,    1921,    1859,   13300,     1.2,     1.2,     1.6,     1.8,     2.3,   236.6,   32.1,  0.02825,      0,      3,     700,     700,       0,   24313</span><br><span class="line">  8 threadCount, total,        247894,    7712,    7529,   19677,     1.0,     1.0,     1.4,     1.6,     2.3,   236.6,   32.1,  0.02825,      0,      3,     700,     700,       0,   24313</span><br><span class="line"> 16 threadCount, insert,       106968,    3253,    3253,    4444,     0.6,     0.5,     0.9,     1.3,     2.2,   243.6,   32.9,  0.01511,      0,      4,     936,     936,       8,   30098</span><br><span class="line"> 16 threadCount, singlepost,   215904,    6566,    6368,    6368,     1.3,     1.2,     1.7,     2.0,     2.9,   252.0,   32.9,  0.01511,      0,      4,     936,     936,       8,   30098</span><br><span class="line"> 16 threadCount, timeline,     106719,    3246,    3149,   22826,     1.4,     1.4,     1.9,     2.2,     3.4,   245.1,   32.9,  0.01511,      0,      4,     936,     936,       8,   30098</span><br><span class="line"> 16 threadCount, total,        429591,   13065,   12770,   33638,     1.1,     1.1,     1.7,     2.0,     2.6,   252.0,   32.9,  0.01511,      0,      4,     936,     936,       8,   30098</span><br><span class="line"> 24 threadCount, insert,       140739,    4170,    4170,    5704,     0.7,     0.6,     1.3,     1.9,    12.9,   220.6,   33.7,  0.01478,      0,      7,    1334,    1334,      13,   47280</span><br><span class="line"> 24 threadCount, singlepost,   281951,    8355,    8115,    8115,     1.5,     1.4,     2.0,     2.5,     4.8,   220.0,   33.7,  0.01478,      0,      7,    1334,    1334,      13,   47280</span><br><span class="line"> 24 threadCount, timeline,     140441,    4162,    4038,   29866,     1.7,     1.6,     2.3,     2.8,     6.7,   219.8,   33.7,  0.01478,      0,      7,    1334,    1334,      13,   47280</span><br><span class="line"> 24 threadCount, total,        563131,   16686,   16323,   43684,     1.3,     1.3,     2.0,     2.4,     4.5,   220.6,   33.7,  0.01478,      0,      7,    1334,    1334,      13,   47280</span><br><span class="line"> 36 threadCount, insert,       159910,    4489,    4489,    6153,     1.2,     0.8,     2.4,     4.0,     9.1,   257.0,   35.6,  0.01898,      0,      9,    1717,    1717,       8,   50212</span><br><span class="line"> 36 threadCount, singlepost,   320744,    9005,    8751,    8751,     2.0,     1.8,     3.1,     4.6,    11.0,   226.2,   35.6,  0.01898,      0,      9,    1717,    1717,       8,   50212</span><br><span class="line"> 36 threadCount, timeline,     160623,    4509,    4382,   33117,     2.3,     2.0,     3.4,     5.3,    10.1,   211.6,   35.6,  0.01898,      0,      9,    1717,    1717,       8,   50212</span><br><span class="line"> 36 threadCount, total,        641277,   18003,   17622,   48021,     1.9,     1.7,     3.1,     4.7,    10.8,   257.0,   35.6,  0.01898,      0,      9,    1717,    1717,       8,   50212</span><br><span class="line"> 54 threadCount, insert,       184306,    4527,    4527,    6189,     2.2,     1.6,     4.6,     8.4,    22.7,   234.8,   40.7,  0.01920,      0,     13,    2092,    2212,      39,   58141</span><br><span class="line"> 54 threadCount, singlepost,   365911,    8988,    8744,    8744,     3.1,     2.5,     5.0,     8.2,    17.6,   237.7,   40.7,  0.01920,      0,     13,    2092,    2212,      39,   58141</span><br><span class="line"> 54 threadCount, timeline,     182207,    4476,    4356,   33754,     3.3,     2.8,     5.3,     8.4,    18.1,   237.4,   40.7,  0.01920,      0,     13,    2092,    2212,      39,   58141</span><br><span class="line"> 54 threadCount, total,        732424,   17991,   17627,   48687,     2.9,     2.4,     5.0,     8.3,    20.4,   237.7,   40.7,  0.01920,      0,     13,    2092,    2212,      39,   58141</span><br><span class="line"> 81 threadCount, insert,       198077,    4603,    4603,    6296,     3.6,     2.8,     7.0,    11.9,    25.0,   282.6,   43.0,  0.01447,      0,      7,    1702,    1702,      17,   61791</span><br><span class="line"> 81 threadCount, singlepost,   392856,    9129,    8895,    8895,     4.5,     3.9,     7.5,    11.9,    25.4,   282.4,   43.0,  0.01447,      0,      7,    1702,    1702,      17,   61791</span><br><span class="line"> 81 threadCount, timeline,     197187,    4582,    4466,   35435,     4.8,     4.2,     7.7,    12.2,    27.2,   282.0,   43.0,  0.01447,      0,      7,    1702,    1702,      17,   61791</span><br><span class="line"> 81 threadCount, total,        788120,   18315,   17964,   50626,     4.3,     3.8,     7.5,    12.0,    26.4,   282.6,   43.0,  0.01447,      0,      7,    1702,    1702,      17,   61791</span><br><span class="line">121 threadCount, insert,       233633,    4512,    4512,    6159,     5.5,     4.3,    11.0,    18.8,    42.2,   352.3,   51.8,  0.01403,      0,     10,    2035,    2035,      13,   83812</span><br><span class="line">121 threadCount, singlepost,   473282,    9140,    8922,    8922,     6.8,     6.0,    10.7,    16.3,   171.5,   253.0,   51.8,  0.01403,      0,     10,    2035,    2035,      13,   83812</span><br><span class="line">121 threadCount, timeline,     236412,    4566,    4455,   36174,     7.1,     6.4,    11.5,    17.6,   197.3,   256.9,   51.8,  0.01403,      0,     10,    2035,    2035,      13,   83812</span><br><span class="line">121 threadCount, total,        943327,   18218,   17889,   51255,     6.5,     5.8,    10.9,    17.2,   186.2,   352.3,   51.8,  0.01403,      0,     10,    2035,    2035,      13,   83812</span><br><span class="line">181 threadCount, insert,       283444,    4539,    4539,    6209,     6.8,     4.2,    14.1,    20.9,   140.7,   237.1,   62.4,  0.01059,      0,     14,    2545,    2545,      13,   92851</span><br><span class="line">181 threadCount, singlepost,   567229,    9083,    8880,    8880,    10.7,    10.0,    16.5,    24.0,   194.7,   235.9,   62.4,  0.01059,      0,     14,    2545,    2545,      13,   92851</span><br><span class="line">181 threadCount, timeline,     283462,    4539,    4437,   36966,    11.1,    10.3,    16.7,    23.2,   181.4,   235.7,   62.4,  0.01059,      0,     14,    2545,    2545,      13,   92851</span><br><span class="line">181 threadCount, total,       1134135,   18162,   17856,   52054,     9.8,     9.7,    16.0,    23.3,   187.3,   237.1,   62.4,  0.01059,      0,     14,    2545,    2545,      13,   92851</span><br></pre></td></tr></table></figure>
<p>G1_24G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,        29865,     941,     941,    1288,     0.4,     0.4,     0.7,     0.9,     1.3,    24.0,   31.7,  0.01344,      0,      1,     189,     189,       0,   13616</span><br><span class="line">  4 threadCount, singlepost,    58981,    1858,    1817,    1817,     1.1,     1.1,     1.4,     1.6,     1.9,   192.1,   31.7,  0.01344,      0,      1,     189,     189,       0,   13616</span><br><span class="line">  4 threadCount, timeline,      29198,     920,     902,    7072,     1.3,     1.3,     1.6,     1.8,     2.2,   192.1,   31.7,  0.01344,      0,      1,     189,     189,       0,   13616</span><br><span class="line">  4 threadCount, total,        118044,    3718,    3660,   10177,     1.0,     1.1,     1.5,     1.7,     1.9,   192.1,   31.7,  0.01344,      0,      1,     189,     189,       0,   13616</span><br><span class="line">  8 threadCount, insert,        54546,    1708,    1708,    2333,     0.5,     0.4,     0.8,     1.0,     2.3,   239.1,   31.9,  0.01014,      0,      2,     396,     396,      33,   27244</span><br><span class="line">  8 threadCount, singlepost,   108726,    3404,    3333,    3333,     1.2,     1.2,     1.5,     1.7,     2.2,   243.7,   31.9,  0.01014,      0,      2,     396,     396,      33,   27244</span><br><span class="line">  8 threadCount, timeline,      55449,    1736,    1698,   13427,     1.4,     1.4,     1.8,     2.0,     2.4,   240.1,   31.9,  0.01014,      0,      2,     396,     396,      33,   27244</span><br><span class="line">  8 threadCount, total,        218721,    6847,    6738,   19092,     1.1,     1.2,     1.6,     1.8,     2.4,   243.7,   31.9,  0.01014,      0,      2,     396,     396,      33,   27244</span><br><span class="line"> 16 threadCount, insert,        95384,    2838,    2838,    3885,     0.6,     0.5,     1.0,     1.6,     8.5,   294.3,   33.6,  0.01193,      0,      3,     721,     721,      37,   40601</span><br><span class="line"> 16 threadCount, singlepost,   192030,    5714,    5599,    5599,     1.5,     1.4,     1.9,     2.3,     3.1,   296.1,   33.6,  0.01193,      0,      3,     721,     721,      37,   40601</span><br><span class="line"> 16 threadCount, timeline,      96518,    2872,    2813,   22426,     1.7,     1.6,     2.1,     2.5,     3.6,   295.6,   33.6,  0.01193,      0,      3,     721,     721,      37,   40601</span><br><span class="line"> 16 threadCount, total,        383932,   11424,   11249,   31909,     1.3,     1.4,     1.9,     2.2,     3.0,   296.1,   33.6,  0.01193,      0,      3,     721,     721,      37,   40601</span><br><span class="line"> 24 threadCount, insert,       123912,    3595,    3595,    4927,     0.8,     0.6,     1.5,     2.1,     4.4,   286.7,   34.5,  0.01224,      0,      4,     990,     990,      20,   53495</span><br><span class="line"> 24 threadCount, singlepost,   244685,    7099,    6955,    6955,     1.8,     1.7,     2.4,     3.0,     4.8,   285.4,   34.5,  0.01224,      0,      4,     990,     990,      20,   53495</span><br><span class="line"> 24 threadCount, timeline,     122475,    3553,    3485,   28206,     2.0,     1.9,     2.7,     3.3,     7.0,   284.8,   34.5,  0.01224,      0,      4,     990,     990,      20,   53495</span><br><span class="line"> 24 threadCount, total,        491072,   14248,   14035,   40087,     1.6,     1.6,     2.4,     3.0,     5.4,   286.7,   34.5,  0.01224,      0,      4,     990,     990,      20,   53495</span><br><span class="line"> 36 threadCount, insert,       141317,    3850,    3850,    5277,     1.3,     1.0,     2.8,     4.8,    16.1,   240.0,   36.7,  0.01231,      0,      4,     913,     913,       7,   52596</span><br><span class="line"> 36 threadCount, singlepost,   284198,    7743,    7596,    7596,     2.4,     2.2,     3.7,     5.4,    10.0,   243.2,   36.7,  0.01231,      0,      4,     913,     913,       7,   52596</span><br><span class="line"> 36 threadCount, timeline,     142241,    3876,    3800,   31128,     2.7,     2.4,     3.9,     5.6,    10.1,   244.6,   36.7,  0.01231,      0,      4,     913,     913,       7,   52596</span><br><span class="line"> 36 threadCount, total,        567756,   15470,   15247,   44000,     2.2,     2.1,     3.7,     5.3,    10.3,   244.6,   36.7,  0.01231,      0,      4,     913,     913,       7,   52596</span><br><span class="line"> 54 threadCount, insert,       147609,    3469,    3469,    4745,     2.8,     2.2,     5.6,     9.2,    18.7,   287.0,   42.6,  0.02038,      0,      5,    1273,    1273,      19,   61300</span><br><span class="line"> 54 threadCount, singlepost,   296313,    6963,    6832,    6832,     4.0,     3.5,     6.4,    10.1,    17.9,   289.4,   42.6,  0.02038,      0,      5,    1273,    1273,      19,   61300</span><br><span class="line"> 54 threadCount, timeline,     148281,    3484,    3420,   28464,     4.3,     3.8,     6.9,    11.0,    19.9,   287.3,   42.6,  0.02038,      0,      5,    1273,    1273,      19,   61300</span><br><span class="line"> 54 threadCount, total,        592203,   13916,   13721,   40040,     3.8,     3.4,     6.4,    10.1,    18.3,   289.4,   42.6,  0.02038,      0,      5,    1273,    1273,      19,   61300</span><br><span class="line"> 81 threadCount, insert,       174282,    3778,    3778,    5162,     4.3,     3.5,     8.1,    13.6,    35.7,   338.4,   46.1,  0.01278,      0,      7,    1466,    1466,      10,   77864</span><br><span class="line"> 81 threadCount, singlepost,   350655,    7600,    7462,    7462,     5.4,     4.9,     8.7,    13.2,    40.4,   248.2,   46.1,  0.01278,      0,      7,    1466,    1466,      10,   77864</span><br><span class="line"> 81 threadCount, timeline,     176191,    3819,    3750,   31705,     5.8,     5.2,     9.1,    14.1,    25.5,   241.2,   46.1,  0.01278,      0,      7,    1466,    1466,      10,   77864</span><br><span class="line"> 81 threadCount, total,        701128,   15197,   14990,   44329,     5.2,     4.7,     8.6,    12.2,    24.5,   338.4,   46.1,  0.01278,      0,      7,    1466,    1466,      10,   77864</span><br><span class="line">121 threadCount, insert,       214800,    3841,    3841,    5256,     6.0,     5.1,    12.3,    19.4,    41.9,   230.0,   55.9,  0.01080,      0,      9,    1730,    1730,       8,   87696</span><br><span class="line">121 threadCount, singlepost,   423920,    7580,    7446,    7446,     8.3,     7.8,    13.5,    20.2,   145.0,   248.7,   55.9,  0.01080,      0,      9,    1730,    1730,       8,   87696</span><br><span class="line">121 threadCount, timeline,     211840,    3788,    3721,   31998,     8.7,     8.1,    13.8,    19.8,    47.7,   250.8,   55.9,  0.01080,      0,      9,    1730,    1730,       8,   87696</span><br><span class="line">121 threadCount, total,        850560,   15208,   15008,   44700,     7.8,     7.4,    13.4,    20.0,    47.6,   250.8,   55.9,  0.01080,      0,      9,    1730,    1730,       8,   87696</span><br></pre></td></tr></table></figure>
<p>G1_32G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,        30936,     973,     973,    1340,     0.4,     0.4,     0.7,     0.9,     1.4,    17.8,   31.8,  0.00898,      0,      1,     214,     214,       0,   13344</span><br><span class="line">  4 threadCount, singlepost,    63324,    1992,    1992,    1992,     1.1,     1.1,     1.3,     1.5,     1.9,   215.8,   31.8,  0.00898,      0,      1,     214,     214,       0,   13344</span><br><span class="line">  4 threadCount, timeline,      31379,     987,     987,    6929,     1.2,     1.2,     1.5,     1.7,     2.2,   215.9,   31.8,  0.00898,      0,      1,     214,     214,       0,   13344</span><br><span class="line">  4 threadCount, total,        125639,    3952,    3952,   10261,     0.9,     1.0,     1.4,     1.6,     1.9,   215.9,   31.8,  0.00898,      0,      1,     214,     214,       0,   13344</span><br><span class="line">  8 threadCount, insert,        59491,    1843,    1843,    2526,     0.5,     0.4,     0.8,     0.9,     1.8,   260.4,   32.3,  0.01028,      0,      2,     446,     446,      36,   27262</span><br><span class="line">  8 threadCount, singlepost,   119048,    3688,    3688,    3688,     1.1,     1.1,     1.4,     1.6,     2.0,   261.8,   32.3,  0.01028,      0,      2,     446,     446,      36,   27262</span><br><span class="line">  8 threadCount, timeline,      59223,    1835,    1834,   12942,     1.3,     1.3,     1.6,     1.8,     2.1,   261.4,   32.3,  0.01028,      0,      2,     446,     446,      36,   27262</span><br><span class="line">  8 threadCount, total,        237762,    7365,    7365,   19155,     1.0,     1.1,     1.5,     1.7,     1.9,   261.8,   32.3,  0.01028,      0,      2,     446,     446,      36,   27262</span><br><span class="line"> 16 threadCount, insert,       130937,    2899,    2899,    3964,     0.7,     0.5,     1.0,     1.6,    11.6,   282.7,   45.2,  0.01953,      0,      4,     935,     935,      10,   53938</span><br><span class="line"> 16 threadCount, singlepost,   260371,    5765,    5765,    5765,     1.4,     1.4,     2.0,     2.5,    18.3,   248.8,   45.2,  0.01953,      0,      4,     935,     935,      10,   53938</span><br><span class="line"> 16 threadCount, timeline,     131599,    2914,    2913,   20924,     1.6,     1.5,     2.2,     2.8,    16.2,   248.8,   45.2,  0.01953,      0,      4,     935,     935,      10,   53938</span><br><span class="line"> 16 threadCount, total,        522907,   11578,   11577,   30652,     1.3,     1.3,     2.0,     2.5,    15.4,   282.7,   45.2,  0.01953,      0,      4,     935,     935,      10,   53938</span><br><span class="line"> 24 threadCount, insert,       130883,    3804,    3804,    5202,     0.8,     0.6,     1.4,     2.3,     9.2,   281.2,   34.4,  0.01905,      0,      4,     960,     960,      24,   50744</span><br><span class="line"> 24 threadCount, singlepost,   260226,    7563,    7563,    7563,     1.6,     1.6,     2.4,     3.2,     7.9,   281.7,   34.4,  0.01905,      0,      4,     960,     960,      24,   50744</span><br><span class="line"> 24 threadCount, timeline,     131484,    3821,    3821,   28081,     1.9,     1.7,     2.7,     3.5,     8.1,   281.9,   34.4,  0.01905,      0,      4,     960,     960,      24,   50744</span><br><span class="line"> 24 threadCount, total,        522593,   15189,   15188,   40845,     1.5,     1.4,     2.4,     3.0,     7.9,   281.9,   34.4,  0.01905,      0,      4,     960,     960,      24,   50744</span><br><span class="line"> 36 threadCount, insert,       188834,    4247,    4247,    5813,     1.3,     0.9,     2.5,     4.1,    10.8,   251.4,   44.5,  0.01940,      0,      7,    1505,    1505,      17,   80632</span><br><span class="line"> 36 threadCount, singlepost,   376070,    8459,    8458,    8458,     2.2,     1.9,     3.4,     5.1,    14.3,   253.9,   44.5,  0.01940,      0,      7,    1505,    1505,      17,   80632</span><br><span class="line"> 36 threadCount, timeline,     187315,    4213,    4213,   31700,     2.5,     2.2,     3.7,     5.4,    11.0,   250.7,   44.5,  0.01940,      0,      7,    1505,    1505,      17,   80632</span><br><span class="line"> 36 threadCount, total,        752219,   16920,   16918,   45970,     2.0,     1.8,     3.4,     5.1,    11.7,   253.9,   44.5,  0.01940,      0,      7,    1505,    1505,      17,   80632</span><br><span class="line"> 54 threadCount, insert,       171633,    4481,    4481,    6135,     2.2,     1.6,     4.7,     8.2,    13.7,   291.3,   38.3,  0.01210,      0,      6,    1124,    1124,       7,   60444</span><br><span class="line"> 54 threadCount, singlepost,   345440,    9018,    9017,    9017,     3.1,     2.6,     5.0,     8.2,    13.6,   211.1,   38.3,  0.01210,      0,      6,    1124,    1124,       7,   60444</span><br><span class="line"> 54 threadCount, timeline,     170465,    4450,    4450,   34329,     3.3,     2.9,     5.5,     9.1,    20.3,   209.1,   38.3,  0.01210,      0,      6,    1124,    1124,       7,   60444</span><br><span class="line"> 54 threadCount, total,        687538,   17950,   17948,   49481,     2.9,     2.5,     5.1,     8.1,    12.3,   291.3,   38.3,  0.01210,      0,      6,    1124,    1124,       7,   60444</span><br><span class="line"> 81 threadCount, insert,       332670,    4041,    4041,    5526,     4.1,     3.2,     8.0,    14.0,    59.9,   283.7,   82.3,  0.01953,      0,     14,    2598,    2713,      44,  141155</span><br><span class="line"> 81 threadCount, singlepost,   669779,    8136,    8135,    8135,     5.0,     4.3,     8.4,    13.5,    41.3,   290.7,   82.3,  0.01953,      0,     14,    2598,    2713,      44,  141155</span><br><span class="line"> 81 threadCount, timeline,     336680,    4090,    4089,   32559,     5.4,     4.6,     8.8,    14.7,    73.9,   290.4,   82.3,  0.01953,      0,     14,    2598,    2713,      44,  141155</span><br><span class="line"> 81 threadCount, total,       1339129,   16267,   16266,   46221,     4.9,     4.2,     8.4,    13.6,    47.7,   290.7,   82.3,  0.01953,      0,     14,    2598,    2713,      44,  141155</span><br><span class="line">121 threadCount, insert,       213975,    3926,    3926,    5368,     6.3,     5.1,    12.4,    19.8,   182.6,   419.9,   54.5,  0.01905,      0,      5,    1791,    1791,      38,   89659</span><br><span class="line">121 threadCount, singlepost,   427658,    7846,    7845,    7845,     7.9,     7.2,    12.9,    18.1,    42.6,   413.9,   54.5,  0.01905,      0,      5,    1791,    1791,      38,   89659</span><br><span class="line">121 threadCount, timeline,     212777,    3904,    3903,   32054,     8.3,     7.5,    13.7,    19.2,    43.7,   413.3,   54.5,  0.01905,      0,      5,    1791,    1791,      38,   89659</span><br><span class="line">121 threadCount, total,        854410,   15675,   15674,   45268,     7.6,     6.9,    13.0,    18.3,    37.3,   419.9,   54.5,  0.01905,      0,      5,    1791,    1791,      38,   89659</span><br></pre></td></tr></table></figure>
<h4 id="只有读取">只有读取</h4><p>./cassandra-stress user profile=./blogpost1.yaml ops(singlepost=1) -node 10.21.21.10 -log file=SINGLENODE9_blog_q1.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, singlepost,    122443,    4069,    3943,    3943,     0.9,     0.8,     1.5,     1.7,     2.1,    41.4,   30.1,  0.01114,      0,      7,     246,     246,       1,   11380</span><br><span class="line">  8 threadCount, singlepost,    235489,    7815,    7565,    7565,     0.9,     0.8,     1.6,     1.8,     2.2,    60.2,   30.1,  0.00628,      0,     12,     426,     426,       2,   19508</span><br><span class="line"> 16 threadCount, singlepost,    414028,   13749,   13311,   13311,     1.1,     0.9,     1.8,     2.2,     2.8,    49.8,   30.1,  0.00339,      0,     18,     653,     653,       2,   29268</span><br><span class="line"> 24 threadCount, singlepost,    544879,   18049,   17474,   17474,     1.2,     1.0,     2.2,     2.6,     4.6,    97.9,   30.2,  0.00540,      0,     22,     865,     865,       3,   35767</span><br><span class="line"> 36 threadCount, singlepost,    656440,   21729,   21036,   21036,     1.6,     1.3,     2.7,     4.0,    10.2,    74.8,   30.2,  0.00489,      0,     26,     959,     959,       1,   42267</span><br><span class="line"> 54 threadCount, singlepost,    719453,   23782,   23027,   23027,     2.2,     1.7,     3.9,     6.9,    21.9,    87.5,   30.3,  0.01074,      0,     26,     949,     949,      10,   44004</span><br><span class="line"> 81 threadCount, singlepost,    822082,   26965,   26101,   26101,     2.9,     2.3,     5.5,    11.4,    39.6,    59.5,   30.5,  0.00400,      0,     26,     899,     899,       2,   42271</span><br><span class="line">121 threadCount, singlepost,    881038,   28869,   27948,   27948,     4.1,     3.3,     7.1,    12.4,    41.9,    75.2,   30.5,  0.00428,      0,     26,     912,     912,       1,   42277</span><br><span class="line">181 threadCount, singlepost,    955638,   31123,   30123,   30123,     5.7,     4.8,     9.5,    15.6,    49.8,   108.2,   30.7,  0.00680,      0,     26,     924,     924,       1,   42275</span><br><span class="line">271 threadCount, singlepost,   1010814,   32952,   31906,   31906,     8.1,     7.1,    12.4,    21.1,    51.6,   168.2,   30.7,  0.01138,      0,     25,     907,     907,       2,   40659</span><br><span class="line">406 threadCount, singlepost,   1034735,   33619,   32562,   32562,    12.0,    10.1,    16.9,    36.3,    58.2,   145.2,   30.8,  0.02330,      0,     22,     822,     822,       1,   35778</span><br><span class="line">609 threadCount, singlepost,   1059253,   34225,   33141,   33141,    17.7,    16.2,    23.2,    57.2,    79.0,   219.8,   30.9,  0.01185,      0,     22,     825,     825,       1,   35796</span><br><span class="line">913 threadCount, singlepost,   1029097,   32958,   31916,   31916,    27.6,    25.9,    31.3,    66.4,   163.6,   309.2,   31.2,  0.01027,      0,     21,     777,     777,       2,   34169</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, singlepost,    109941,    3639,    3560,    3560,     1.0,     1.0,     1.4,     1.6,     1.8,   178.4,   30.2,  0.00904,      0,      2,     320,     320,      16,   11256</span><br><span class="line">  8 threadCount, singlepost,    207401,    6893,    6743,    6743,     1.1,     1.1,     1.4,     1.6,     1.9,   145.8,   30.1,  0.00604,      0,      3,     422,     422,       3,   16829</span><br><span class="line"> 16 threadCount, singlepost,    354764,   11775,   11517,   11517,     1.3,     1.2,     1.7,     2.0,     2.6,   139.1,   30.1,  0.00768,      0,      6,     800,     800,       3,   33620</span><br><span class="line"> 24 threadCount, singlepost,    448907,   14829,   14506,   14506,     1.5,     1.4,     2.2,     2.7,     4.6,   143.3,   30.3,  0.01183,      0,      7,     880,     880,      16,   39657</span><br><span class="line"> 36 threadCount, singlepost,    492859,   16296,   15946,   15946,     2.1,     1.9,     3.4,     5.6,    10.4,   104.4,   30.2,  0.00672,      0,      7,     589,     589,       6,   40129</span><br><span class="line"> 54 threadCount, singlepost,    503342,   16622,   16262,   16262,     3.2,     2.8,     5.2,     8.5,    15.2,   103.2,   30.3,  0.00200,      0,      8,     597,     597,       3,   45974</span><br><span class="line"> 81 threadCount, singlepost,    516925,   17020,   16647,   16647,     4.7,     4.2,     7.7,    12.4,    78.0,    99.8,   30.4,  0.00587,      0,      7,     518,     518,       2,   40218</span><br><span class="line">121 threadCount, singlepost,    525550,   17186,   16816,   16816,     6.9,     6.2,    11.5,    16.5,    82.1,   111.6,   30.6,  0.00364,      0,      8,     588,     588,       2,   45943</span><br><span class="line">181 threadCount, singlepost,    544759,   17741,   17353,   17353,    10.1,     9.2,    15.7,    20.7,    87.8,   120.6,   30.7,  0.00363,      0,      8,     596,     596,       2,   45887</span><br><span class="line">271 threadCount, singlepost,    551750,   17863,   17477,   17477,    15.1,    14.0,    22.4,    27.7,    96.8,   144.2,   30.9,  0.00352,      0,      8,     587,     587,       3,   45895</span><br></pre></td></tr></table></figure>
<p>G1_24G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, singlepost,     92111,    3061,    3008,    3008,     1.2,     1.2,     1.5,     1.6,     1.9,   166.0,   30.1,  0.00286,      0,      1,     163,     163,       0,    8953</span><br><span class="line">  8 threadCount, singlepost,    173858,    5753,    5654,    5654,     1.3,     1.3,     1.6,     1.8,     2.0,   137.5,   30.2,  0.00164,      0,      2,     268,     268,       0,   18140</span><br><span class="line"> 16 threadCount, singlepost,    285754,    9470,    9312,    9312,     1.6,     1.5,     2.1,     2.5,     3.3,   141.4,   30.2,  0.00497,      0,      4,     545,     545,       2,   36332</span><br><span class="line"> 24 threadCount, singlepost,    339980,   11279,   11079,   11079,     2.0,     1.9,     2.9,     3.6,     6.2,   154.3,   30.1,  0.00245,      0,      5,     701,     701,       5,   45509</span><br><span class="line"> 36 threadCount, singlepost,    364567,   12065,   11862,   11862,     2.9,     2.6,     4.4,     6.7,    11.8,   125.5,   30.2,  0.00387,      0,      5,     469,     469,      16,   46767</span><br><span class="line"> 54 threadCount, singlepost,    374115,   12349,   12135,   12135,     4.3,     4.0,     6.9,    10.4,    16.1,    96.2,   30.3,  0.00199,      0,      5,     382,     382,       2,   46894</span><br><span class="line"> 81 threadCount, singlepost,    390179,   12834,   12610,   12610,     6.2,     5.9,    10.3,    15.3,    26.7,   112.0,   30.4,  0.00922,      0,      5,     395,     395,       3,   46911</span><br><span class="line">121 threadCount, singlepost,    412920,   13492,   13259,   13259,     8.9,     8.1,    14.5,    19.9,    33.7,   123.5,   30.6,  0.00379,      0,      5,     391,     391,       2,   46859</span><br><span class="line">181 threadCount, singlepost,    439554,   14237,   13989,   13989,    12.6,    11.7,    19.8,    25.0,    94.3,   139.9,   30.9,  0.00353,      0,      6,     465,     465,       2,   56229</span><br><span class="line">271 threadCount, singlepost,    459036,   14783,   14527,   14527,    18.2,    17.3,    26.3,    31.4,   107.9,   150.9,   31.1,  0.00419,      0,      5,     386,     386,       2,   46835</span><br><span class="line">406 threadCount, singlepost,    472232,   15120,   14857,   14857,    26.7,    25.4,    34.9,    47.8,   110.0,   147.2,   31.2,  0.00490,      0,      6,     473,     473,       2,   56115</span><br><span class="line">609 threadCount, singlepost,    495949,   15634,   15357,   15357,    38.9,    37.7,    48.3,    57.1,   213.9,   238.0,   31.7,  0.00602,      0,      5,     400,     400,       3,   46782</span><br><span class="line">913 threadCount, singlepost,    509520,   15849,   15572,   15572,    57.6,    53.7,    72.2,   138.2,   210.9,   245.9,   32.1,  0.00958,      0,      6,     480,     480,       3,   56182</span><br></pre></td></tr></table></figure>
<p>G1_32G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, singlepost,     99639,    3285,    3285,    3285,     1.1,     1.1,     1.6,     2.0,     2.6,   285.7,   30.3,  0.00463,      0,      1,     283,     283,       0,   17966</span><br><span class="line">  8 threadCount, singlepost,    190521,    6331,    6331,    6331,     1.2,     1.1,     1.7,     2.0,     2.6,   238.7,   30.1,  0.00805,      0,      1,     235,     235,       0,   18336</span><br><span class="line"> 16 threadCount, singlepost,    330162,   10888,   10888,   10888,     1.4,     1.3,     2.0,     2.3,     3.0,   234.4,   30.3,  0.00838,      0,      2,     436,     436,      13,   36640</span><br><span class="line"> 24 threadCount, singlepost,    422433,   13919,   13918,   13918,     1.6,     1.5,     2.5,     3.1,     4.7,   229.7,   30.3,  0.00868,      0,      2,     444,     444,       3,   36672</span><br><span class="line"> 36 threadCount, singlepost,    495485,   16338,   16337,   16337,     2.1,     1.9,     3.4,     5.1,     8.5,   219.4,   30.3,  0.00704,      0,      3,     629,     629,       4,   54968</span><br><span class="line"> 54 threadCount, singlepost,    540856,   17748,   17746,   17746,     3.0,     2.5,     5.0,     8.2,    13.3,   235.9,   30.5,  0.00533,      0,      3,     655,     655,       7,   54933</span><br><span class="line"> 81 threadCount, singlepost,    542694,   17868,   17866,   17866,     4.4,     3.9,     7.6,    12.3,    20.1,   225.0,   30.4,  0.00681,      0,      2,     381,     381,      17,   37201</span><br><span class="line">121 threadCount, singlepost,    572196,   18786,   18785,   18785,     6.3,     5.4,    11.5,    17.8,    31.0,   155.7,   30.5,  0.01925,      0,      3,     349,     349,      21,   57439</span><br><span class="line">181 threadCount, singlepost,    642455,   20933,   20931,   20931,     8.5,     7.7,    13.5,    18.2,    36.2,   119.7,   30.7,  0.00638,      0,      3,     228,     228,       2,   58005</span><br><span class="line">271 threadCount, singlepost,    653435,   21239,   21237,   21237,    12.7,    11.7,    18.8,    23.3,    86.6,   162.8,   30.8,  0.01504,      0,      3,     226,     226,       2,   58039</span><br><span class="line">406 threadCount, singlepost,    651626,   20891,   20889,   20889,    19.3,    18.1,    26.6,    31.8,   135.3,   157.1,   31.2,  0.00646,      0,      3,     224,     224,       1,   58031</span><br><span class="line">609 threadCount, singlepost,    649846,   20818,   20816,   20816,    29.2,    28.4,    39.0,    49.2,   140.8,   168.4,   31.2,  0.00658,      0,      3,     220,     220,       1,   58031</span><br></pre></td></tr></table></figure>
<p>./cassandra-stress user profile=./blogpost1.yaml ops(timeline=1) -node 10.21.21.10 -log file=SINGLENODE10_blog_q2.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, timeline,     141365,    4698,    4551,   35081,     0.8,     0.8,     1.0,     1.2,     1.3,    29.3,   30.1,  0.00663,      0,      7,     180,     180,       1,   11430</span><br><span class="line">  8 threadCount, timeline,     265718,    8824,    8538,   65799,     0.8,     0.8,     1.1,     1.2,     1.6,    46.5,   30.1,  0.00213,      0,     12,     322,     322,       2,   19593</span><br><span class="line"> 16 threadCount, timeline,     474596,   15761,   15255,  117608,     0.9,     0.9,     1.2,     1.4,     2.2,    30.6,   30.1,  0.00551,      0,     20,     526,     526,       1,   32658</span><br><span class="line"> 24 threadCount, timeline,     636296,   21118,   20452,  157511,     1.0,     1.0,     1.4,     1.7,     3.5,    38.3,   30.1,  0.00725,      0,     26,     698,     698,       2,   42462</span><br><span class="line"> 36 threadCount, timeline,     783994,   25984,   25153,  193866,     1.3,     1.2,     2.0,     2.9,    10.2,    32.2,   30.2,  0.00573,      0,     32,     804,     858,       1,   52263</span><br><span class="line"> 54 threadCount, timeline,     829706,   27400,   26524,  204420,     1.9,     1.5,     3.3,     6.3,    14.7,    43.7,   30.3,  0.00411,      0,     33,     805,     884,       1,   53898</span><br><span class="line"> 81 threadCount, timeline,     845373,   27903,   27028,  208271,     2.8,     2.2,     5.1,     9.8,    31.3,    59.9,   30.3,  0.00598,      0,     33,     815,     897,       1,   53902</span><br><span class="line">121 threadCount, timeline,     867840,   28402,   27500,  211936,     4.2,     3.3,     7.4,    13.9,    35.8,    74.6,   30.6,  0.00515,      0,     34,     814,     920,       2,   55536</span><br><span class="line">181 threadCount, timeline,     864168,   28392,   27486,  211904,     6.3,     5.6,    10.1,    15.0,    36.1,   109.1,   30.4,  0.00668,      0,     33,     792,     868,       1,   53909</span><br><span class="line">271 threadCount, timeline,     850865,   27816,   26934,  207565,     9.6,     8.9,    14.4,    20.4,    45.8,   168.7,   30.6,  0.00722,      0,     31,     796,     822,       1,   50649</span><br></pre></td></tr></table></figure>
<p>G1_16G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, timeline,      94817,    3150,    3081,   26009,     1.2,     1.2,     1.5,     1.7,     1.9,    79.5,   30.1,  0.01005,      0,      3,     226,     226,       2,   17204</span><br><span class="line">  8 threadCount, timeline,     180270,    5989,    5857,   49467,     1.3,     1.3,     1.6,     1.8,     2.1,    77.2,   30.1,  0.00188,      0,      4,     285,     285,       2,   22916</span><br><span class="line"> 16 threadCount, timeline,     309748,   10283,   10060,   84849,     1.5,     1.4,     1.9,     2.2,     2.8,    78.7,   30.1,  0.00332,      0,      7,     485,     485,       3,   40163</span><br><span class="line"> 24 threadCount, timeline,     390132,   12948,   12665,  106703,     1.8,     1.7,     2.5,     3.1,     5.9,    74.7,   30.1,  0.00768,      0,      8,     525,     525,       3,   45882</span><br><span class="line"> 36 threadCount, timeline,     409718,   13539,   13247,  111801,     2.6,     2.3,     4.0,     6.0,    10.0,    80.8,   30.3,  0.00283,      0,      9,     597,     597,       2,   51530</span><br><span class="line"> 54 threadCount, timeline,     419480,   13781,   13479,  113650,     3.8,     3.5,     6.1,     9.2,    69.8,    81.4,   30.4,  0.00249,      0,      9,     597,     597,       1,   51606</span><br><span class="line"> 81 threadCount, timeline,     424742,   13963,   13663,  115244,     5.7,     5.4,     9.1,    13.3,    72.4,    98.2,   30.4,  0.00410,      0,     10,     666,     666,       2,   57182</span><br><span class="line">121 threadCount, timeline,     453080,   14847,   14527,  122499,     8.0,     7.4,    12.9,    17.5,    48.8,    98.5,   30.5,  0.00354,      0,      9,     601,     601,       2,   51426</span><br><span class="line">181 threadCount, timeline,     484441,   15578,   15240,  128493,    11.5,    10.4,    18.1,    24.0,    84.9,   121.2,   31.1,  0.00916,      0,     10,     658,     658,       2,   57159</span><br><span class="line">271 threadCount, timeline,     497398,   16078,   15732,  132660,    16.7,    15.4,    25.0,    32.6,    88.4,   157.2,   30.9,  0.00627,      0,     10,     648,     648,       2,   57157</span><br><span class="line">406 threadCount, timeline,     495006,   15889,   15550,  131065,    25.4,    24.3,    36.4,    65.2,   107.0,   139.0,   31.2,  0.00792,      0,     10,     662,     662,       2,   57141</span><br><span class="line">609 threadCount, timeline,     494388,   15750,   15409,  129898,    38.6,    39.5,    51.2,    65.6,   316.1,   328.2,   31.4,  0.01020,      0,      9,     602,     602,       3,   51304</span><br><span class="line">913 threadCount, timeline,     513498,   16183,   15834,  133546,    56.3,    54.7,    74.1,   123.2,   181.0,   234.1,   31.7,  0.01149,      0,      9,     595,     595,       5,   51276</span><br></pre></td></tr></table></figure>
<p>G1_24G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, timeline,      92842,    3085,    3033,   26250,     1.2,     1.3,     1.7,     1.8,     2.1,    80.6,   30.1,  0.00626,      0,      1,      78,      78,       0,    9368</span><br><span class="line">  8 threadCount, timeline,     178117,    5917,    5817,   50390,     1.3,     1.4,     1.8,     2.0,     2.3,    80.6,   30.1,  0.00197,      0,      3,     229,     229,       2,   28092</span><br><span class="line"> 16 threadCount, timeline,     312579,   10362,   10186,   88208,     1.5,     1.5,     2.1,     2.4,     3.2,    82.0,   30.2,  0.00372,      0,      4,     301,     301,       2,   37464</span><br><span class="line"> 24 threadCount, timeline,     399572,   13245,   13017,  112750,     1.7,     1.8,     2.6,     3.3,     5.4,    83.3,   30.2,  0.00266,      0,      6,     447,     447,       2,   56207</span><br><span class="line"> 36 threadCount, timeline,     439440,   14540,   14291,  123743,     2.4,     2.2,     4.0,     6.0,    10.2,    90.0,   30.2,  0.00303,      0,      5,     374,     374,       2,   46855</span><br><span class="line"> 54 threadCount, timeline,     486527,   13926,   13693,  118602,     3.8,     3.4,     6.6,     9.7,    17.6,   916.4,   34.9,  0.01927,      0,      6,     444,     444,       5,   56223</span><br><span class="line"> 81 threadCount, timeline,     454010,   14970,   14714,  127580,     5.3,     4.8,     9.2,    14.0,    39.8,   175.2,   30.3,  0.01782,      0,      6,     485,     485,       7,   56195</span><br><span class="line">121 threadCount, timeline,     503869,   16544,   16259,  140877,     7.2,     6.6,    12.3,    17.0,    81.2,   106.9,   30.5,  0.00660,      0,      6,     440,     440,       2,   56155</span><br><span class="line">181 threadCount, timeline,     544709,   17747,   17446,  151122,    10.1,     9.3,    15.8,    21.1,    87.0,   131.8,   30.7,  0.00631,      0,      6,     426,     426,       2,   56127</span><br><span class="line">271 threadCount, timeline,     569370,   18463,   18148,  157275,    14.6,    13.5,    22.3,    26.8,    89.7,   149.3,   30.8,  0.00454,      0,      6,     463,     463,      15,   56122</span><br><span class="line">406 threadCount, timeline,     560757,   17992,   17679,  153140,    22.4,    21.9,    32.9,    42.1,   133.9,   198.9,   31.2,  0.01142,      0,      6,     414,     414,       3,   56115</span><br><span class="line">609 threadCount, timeline,     579726,   18491,   18181,  157507,    32.8,    32.1,    44.9,    59.0,   141.0,   177.7,   31.4,  0.00779,      0,      6,     421,     421,       6,   56091</span><br><span class="line">913 threadCount, timeline,     609238,   19220,   18888,  163580,    47.4,    45.8,    58.4,   111.9,   283.9,   306.1,   31.7,  0.01073,      0,      6,     414,     414,       2,   56103</span><br></pre></td></tr></table></figure>
<p>G1_32G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, timeline,     106287,    3532,    3532,   29277,     1.1,     1.1,     1.4,     1.5,     1.7,    77.9,   30.1,  0.00395,      0,      1,      76,      76,       0,   19328</span><br><span class="line">  8 threadCount, timeline,     200907,    6677,    6676,   55365,     1.1,     1.1,     1.4,     1.6,     1.8,    79.5,   30.1,  0.00313,      0,      1,      76,      76,       0,   19335</span><br><span class="line"> 16 threadCount, timeline,     350519,   11640,   11639,   96518,     1.3,     1.3,     1.7,     1.9,     2.6,    82.9,   30.1,  0.01155,      0,      3,     224,     224,       3,   58033</span><br><span class="line"> 24 threadCount, timeline,     454119,   15074,   15073,  124972,     1.5,     1.4,     2.1,     2.6,     4.1,    83.0,   30.1,  0.00830,      0,      3,     225,     225,       4,   58022</span><br><span class="line"> 36 threadCount, timeline,     485724,   16081,   16080,  133276,     2.1,     1.9,     3.4,     5.2,     8.3,    80.1,   30.2,  0.00793,      0,      3,     216,     216,       0,   58039</span><br><span class="line"> 54 threadCount, timeline,     493962,   16307,   16306,  135098,     3.2,     2.9,     5.3,     8.8,    14.4,    90.9,   30.3,  0.00459,      0,      3,     223,     223,       1,   58007</span><br><span class="line"> 81 threadCount, timeline,     496295,   16383,   16382,  135850,     4.8,     4.4,     7.9,    11.7,    22.5,   114.7,   30.3,  0.00669,      0,      4,     293,     293,       1,   77393</span><br><span class="line">121 threadCount, timeline,     509577,   16710,   16708,  138473,     7.1,     6.4,    11.6,    15.8,    34.3,    92.5,   30.5,  0.00294,      0,      3,     215,     215,       1,   58039</span><br><span class="line">181 threadCount, timeline,     526174,   17130,   17129,  142058,    10.5,     9.6,    16.1,    20.2,    33.4,   114.9,   30.7,  0.00473,      0,      4,     295,     295,       2,   77407</span><br><span class="line">271 threadCount, timeline,     530603,   17213,   17212,  142632,    15.6,    14.6,    23.7,    29.1,    97.5,   154.6,   30.8,  0.00926,      0,      3,     220,     220,       3,   58047</span><br></pre></td></tr></table></figure>
<h3 id="G1测试">G1测试</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress write n=50000000 truncate=always -node 10.21.21.10 </span></span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress write n=50000000 cl=ONE truncate=always -mode native cql3 -node 10.21.21.10 </span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress <span class="built_in">read</span> n=200000 no-warmup -rate threads\&gt;=16 -node 10.21.21.10</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress mixed ratio\(write=1,<span class="built_in">read</span>=3\) n=100000 cl=ONE -pop dist=UNIFORM\(1..1000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 -node 10.21.21.10</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress mixed ratio\(write=3,<span class="built_in">read</span>=1\) n=100000 cl=ONE -pop dist=UNIFORM\(1..1000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 -node 10.21.21.10</span><br></pre></td></tr></table></figure>
<p>CMS Heap/New=8G/2G</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Results:</span><br><span class="line">op rate                   : 126219 [WRITE:126219]</span><br><span class="line">partition rate            : 126219 [WRITE:126219]</span><br><span class="line">row rate                  : 126219 [WRITE:126219]</span><br><span class="line">latency mean              : 1.6 [WRITE:1.6]</span><br><span class="line">latency median            : 1.3 [WRITE:1.3]</span><br><span class="line">latency 95th percentile   : 1.9 [WRITE:1.9]</span><br><span class="line">latency 99th percentile   : 3.0 [WRITE:3.0]</span><br><span class="line">latency 99.9th percentile : 19.2 [WRITE:19.2]</span><br><span class="line">latency max               : 5649.4 [WRITE:5649.4]</span><br><span class="line">Total partitions          : 50000000 [WRITE:50000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 335</span><br><span class="line">total gc mb               : 486236</span><br><span class="line">total gc time (s)         : 41</span><br><span class="line">avg gc time(ms)           : 121</span><br><span class="line">stdev gc time(ms)         : 223</span><br><span class="line">Total operation time      : 00:06:36</span><br></pre></td></tr></table></figure>
<p>G1 Heap=16G(16384M)，或者微调G1的选项，设置目标GC时间为1s，设置当堆内存占用60%时触发执行GC。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#JVM_OPTS=&quot;$JVM_OPTS -XX:MaxGCPauseMillis=500&quot;</span><br><span class="line">JVM_OPTS=&quot;$JVM_OPTS -XX:MaxGCPauseMillis=1000&quot;</span><br><span class="line">JVM_OPTS=&quot;$JVM_OPTS -XX:InitiatingHeapOccupancyPercent=60&quot;</span><br></pre></td></tr></table></figure>
<p>测试结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">op rate                   : 117340 [WRITE:117340]</span><br><span class="line">partition rate            : 117340 [WRITE:117340]</span><br><span class="line">row rate                  : 117340 [WRITE:117340]</span><br><span class="line">latency mean              : 1.7 [WRITE:1.7]</span><br><span class="line">latency median            : 1.3 [WRITE:1.3]</span><br><span class="line">latency 95th percentile   : 2.7 [WRITE:2.7]</span><br><span class="line">latency 99th percentile   : 4.1 [WRITE:4.1]</span><br><span class="line">latency 99.9th percentile : 13.2 [WRITE:13.2]</span><br><span class="line">latency max               : 654.6 [WRITE:654.6]</span><br><span class="line">Total partitions          : 50000000 [WRITE:50000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 102</span><br><span class="line">total gc mb               : 508991</span><br><span class="line">total gc time (s)         : 23</span><br><span class="line">avg gc time(ms)           : 226</span><br><span class="line">stdev gc time(ms)         : 80</span><br><span class="line">Total operation time      : 00:07:06</span><br></pre></td></tr></table></figure>
<p>G1 Heap=24G(24576M)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">op rate                   : 134586 [WRITE:134586]</span><br><span class="line">partition rate            : 134586 [WRITE:134586]</span><br><span class="line">row rate                  : 134586 [WRITE:134586]</span><br><span class="line">latency mean              : 1.5 [WRITE:1.5]</span><br><span class="line">latency median            : 1.3 [WRITE:1.3]</span><br><span class="line">latency 95th percentile   : 1.6 [WRITE:1.6]</span><br><span class="line">latency 99th percentile   : 2.5 [WRITE:2.5]</span><br><span class="line">latency 99.9th percentile : 6.4 [WRITE:6.4]</span><br><span class="line">latency max               : 637.7 [WRITE:637.7]</span><br><span class="line">Total partitions          : 50000000 [WRITE:50000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 60</span><br><span class="line">total gc mb               : 438681</span><br><span class="line">total gc time (s)         : 21</span><br><span class="line">avg gc time(ms)           : 346</span><br><span class="line">stdev gc time(ms)         : 102</span><br><span class="line">Total operation time      : 00:06:11</span><br></pre></td></tr></table></figure>
<p>JDK: zulu8.15.0.1-jdk8.0.92-linux_x64<br>测试结果显示，zulu在24G下并没有性能提升，相反每秒钟的吞吐量下降了2万多，GC也好不到哪里去。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">op rate                   : 111652 [WRITE:111652]</span><br><span class="line">partition rate            : 111652 [WRITE:111652]</span><br><span class="line">row rate                  : 111652 [WRITE:111652]</span><br><span class="line">latency mean              : 1.8 [WRITE:1.8]</span><br><span class="line">latency median            : 1.4 [WRITE:1.4]</span><br><span class="line">latency 95th percentile   : 2.9 [WRITE:2.9]</span><br><span class="line">latency 99th percentile   : 4.5 [WRITE:4.5]</span><br><span class="line">latency 99.9th percentile : 11.8 [WRITE:11.8]</span><br><span class="line">latency max               : 1820.3 [WRITE:1820.3]</span><br><span class="line">Total partitions          : 50000000 [WRITE:50000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 67</span><br><span class="line">total gc mb               : 435180</span><br><span class="line">total gc time (s)         : 23</span><br><span class="line">avg gc time(ms)           : 344</span><br><span class="line">stdev gc time(ms)         : 146</span><br><span class="line">Total operation time      : 00:07:27</span><br></pre></td></tr></table></figure>
<p>G1 Heap=32G(32768M)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">op rate                   : 120814 [WRITE:120814]</span><br><span class="line">partition rate            : 120814 [WRITE:120814]</span><br><span class="line">row rate                  : 120814 [WRITE:120814]</span><br><span class="line">latency mean              : 1.6 [WRITE:1.6]</span><br><span class="line">latency median            : 1.3 [WRITE:1.3]</span><br><span class="line">latency 95th percentile   : 2.4 [WRITE:2.4]</span><br><span class="line">latency 99th percentile   : 3.9 [WRITE:3.9]</span><br><span class="line">latency 99.9th percentile : 11.1 [WRITE:11.1]</span><br><span class="line">latency max               : 1622.8 [WRITE:1622.8]</span><br><span class="line">Total partitions          : 50000000 [WRITE:50000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 51</span><br><span class="line">total gc mb               : 567608</span><br><span class="line">total gc time (s)         : 22</span><br><span class="line">avg gc time(ms)           : 429</span><br><span class="line">stdev gc time(ms)         : 144</span><br><span class="line">Total operation time      : 00:06:53</span><br></pre></td></tr></table></figure>
<p>9个节点的集群: /home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress write n=50000000 cl=ONE truncate=always -mode native cql3 -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">op rate                   : 308252 [WRITE:308252]</span><br><span class="line">partition rate            : 308252 [WRITE:308252]</span><br><span class="line">row rate                  : 308252 [WRITE:308252]</span><br><span class="line">latency mean              : 0.6 [WRITE:0.6]</span><br><span class="line">latency median            : 0.3 [WRITE:0.3]</span><br><span class="line">latency 95th percentile   : 2.1 [WRITE:2.1]</span><br><span class="line">latency 99th percentile   : 3.2 [WRITE:3.2]</span><br><span class="line">latency 99.9th percentile : 6.2 [WRITE:6.2]</span><br><span class="line">latency max               : 495.6 [WRITE:495.6]</span><br><span class="line">Total partitions          : 50000000 [WRITE:50000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 83</span><br><span class="line">total gc mb               : 633231</span><br><span class="line">total gc time (s)         : 14</span><br><span class="line">avg gc time(ms)           : 165</span><br><span class="line">stdev gc time(ms)         : 101</span><br><span class="line">Total operation time      : 00:02:42</span><br></pre></td></tr></table></figure>
<h3 id="集群测试">集群测试</h3><p>10.21.21.10,10.21.21.11,10.21.21.12,10.21.21.13,10.21.21.14,10.21.21.15,10.21.21.16,10.21.21.17,10.21.21.18<br>10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130</p>
<p>nohup sh stress1.sh &gt; stress1.log 2&gt;&amp;1 &amp;</p>
<p>100万写，20万读，10万混合读写；5000万写，100万混合读写；自定义表结构</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress write n=1000000 -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER401_write_10M.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress <span class="built_in">read</span> n=200000 -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER402_read_2.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress <span class="built_in">read</span> n=200000 no-warmup -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER403_read_2_nowarm.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress <span class="built_in">read</span> duration=3m -rate threads\&gt;=16 -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER404_read_3min.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress mixed ratio\(write=1,<span class="built_in">read</span>=3\) n=100000 cl=ONE -pop dist=UNIFORM\(1..10000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 -<span class="built_in">log</span> file=CLUSTER405_mixed_read3_10M.log -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress mixed ratio\(write=3,<span class="built_in">read</span>=1\) n=100000 cl=ONE -pop dist=UNIFORM\(1..10000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 -<span class="built_in">log</span> file=CLUSTER406_mixed_write3_10M.log -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress write n=50000000 cl=ONE -mode native cql3 -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER407_write_50M.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress mixed ratio\(write=1,<span class="built_in">read</span>=3\) n=1000000 cl=ONE -pop dist=UNIFORM\(1..10000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 -<span class="built_in">log</span> file=CLUSTER408_mixed_read3_100M.log -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress mixed ratio\(write=3,<span class="built_in">read</span>=1\) n=1000000 cl=ONE -pop dist=UNIFORM\(1..10000000\) -schema keyspace=<span class="string">"keyspace1"</span> -mode native cql3 -rate threads\&gt;=16 -<span class="built_in">log</span> file=CLUSTER409_mixed_write3_100M.log -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130</span><br><span class="line"></span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress user profile=blogpost3.yaml ops\(insert=1\) -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER410_blog_insert.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress user profile=blogpost3.yaml ops\(singlepost=2,timeline=1,insert=1\) -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER411_blog_mixed.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress user profile=blogpost3.yaml ops\(singlepost=1\) -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER412_blog_q1.log</span><br><span class="line">/home/admin/apache-cassandra-2.2.6/tools/bin/cassandra-stress user profile=blogpost3.yaml ops\(timeline=1\) -node 10.21.21.19,10.21.21.20,10.21.21.21,10.21.21.22,10.21.21.23,10.21.21.24,10.21.21.25,10.21.21.26,10.21.21.130 -<span class="built_in">log</span> file=CLUSTER413_blog_q2.log</span><br></pre></td></tr></table></figure>
<p>CLUSTER41_write_1M.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Results:</span><br><span class="line">op rate                   : 259897 [WRITE:259897]</span><br><span class="line">partition rate            : 259897 [WRITE:259897]</span><br><span class="line">row rate                  : 259897 [WRITE:259897]</span><br><span class="line">latency mean              : 0.8 [WRITE:0.8]</span><br><span class="line">latency median            : 0.5 [WRITE:0.5]</span><br><span class="line">latency 95th percentile   : 1.4 [WRITE:1.4]</span><br><span class="line">latency 99th percentile   : 2.0 [WRITE:2.0]</span><br><span class="line">latency 99.9th percentile : 30.7 [WRITE:30.7]</span><br><span class="line">latency max               : 95.2 [WRITE:95.2]</span><br><span class="line">Total partitions          : 1000000 [WRITE:1000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 4</span><br><span class="line">total gc mb               : 6166</span><br><span class="line">total gc time (s)         : 0</span><br><span class="line">avg gc time(ms)           : 79</span><br><span class="line">stdev gc time(ms)         : 9</span><br><span class="line">Total operation time      : 00:00:03</span><br></pre></td></tr></table></figure>
<p>CLUSTER42_read_2.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   21460,   21460,   21460,     0.2,     0.2,     0.2,     0.3,     0.5,    10.6,    9.3,  0.00255,      0,      0,       0,       0,       0,       0</span><br><span class="line">  8 threadCount, READ,         200000,   38502,   38502,   38502,     0.2,     0.2,     0.3,     0.3,     0.6,   140.3,    5.2,  0.00191,      0,      1,     139,     139,       0,    1547</span><br><span class="line"> 16 threadCount, READ,         200000,   71834,   71834,   71834,     0.2,     0.2,     0.3,     0.4,     0.6,    16.0,    2.8,  0.00155,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, READ,         200000,   83062,   83062,   83062,     0.3,     0.2,     0.3,     0.6,     1.3,   121.3,    2.4,  0.04126,      0,      3,     349,     349,       3,    4624</span><br><span class="line"> 36 threadCount, READ,         200000,  134469,  134469,  134469,     0.3,     0.2,     0.4,     0.5,     0.7,     3.7,    1.5,  0.00428,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 54 threadCount, READ,         200000,  162900,  162900,  162900,     0.3,     0.3,     0.5,     0.6,     0.8,    40.7,    1.2,  0.01089,      0,      1,      39,      39,       0,    1678</span><br><span class="line"> 81 threadCount, READ,         200000,  216457,  216457,  216457,     0.4,     0.3,     0.6,     0.8,     1.5,     5.8,    0.9,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, READ,         200000,  236040,  236040,  236040,     0.5,     0.4,     0.9,     1.2,    14.8,    40.8,    0.8,  0.00000,      0,      2,      26,      26,       0,    3428</span><br><span class="line">181 threadCount, READ,         200000,  286542,  286542,  286542,     0.6,     0.5,     1.2,     1.6,     1.8,    16.6,    0.7,  0.00000,      0,      1,      12,      12,       0,    1713</span><br><span class="line">271 threadCount, READ,         200000,  299832,  299832,  299832,     0.9,     0.7,     2.0,     2.4,     3.5,    45.7,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">406 threadCount, READ,         200000,  321774,  321774,  321774,     1.3,     1.0,     3.2,     4.2,     6.9,    20.1,    0.6,  0.00000,      0,      1,      12,      12,       0,    1662</span><br><span class="line">609 threadCount, READ,         200000,  266682,  266682,  266682,     2.4,     1.2,     6.3,    14.6,    84.6,    88.3,    0.7,  0.00000,      0,      1,      12,      12,       0,    1659</span><br></pre></td></tr></table></figure>
<p>CLUSTER43_read_2_nowarm.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,         200000,   20221,   20221,   20221,     0.2,     0.2,     0.2,     0.3,     0.8,    14.0,    9.9,  0.02496,      0,      1,      12,      12,       0,    1658</span><br><span class="line">  8 threadCount, READ,         200000,   39354,   39354,   39354,     0.2,     0.2,     0.3,     0.3,     0.5,    15.9,    5.1,  0.00334,      0,      1,      13,      13,       0,    1657</span><br><span class="line"> 16 threadCount, READ,         200000,   69779,   69779,   69779,     0.2,     0.2,     0.3,     0.4,     0.8,    14.0,    2.9,  0.00565,      0,      1,      13,      13,       0,    1643</span><br><span class="line"> 24 threadCount, READ,         200000,   95817,   95817,   95817,     0.2,     0.2,     0.3,     0.5,     0.9,    14.0,    2.1,  0.00720,      0,      1,      12,      12,       0,    1643</span><br><span class="line"> 36 threadCount, READ,         200000,  130448,  130448,  130448,     0.3,     0.2,     0.4,     0.6,     1.9,    19.1,    1.5,  0.00538,      0,      1,      13,      13,       0,    1642</span><br><span class="line"> 54 threadCount, READ,         200000,  161641,  161641,  161641,     0.3,     0.3,     0.5,     0.6,     1.0,    41.0,    1.2,  0.00939,      0,      1,      13,      13,       0,    1640</span><br><span class="line"> 81 threadCount, READ,         200000,  207644,  207644,  207644,     0.4,     0.3,     0.6,     0.8,     1.2,    14.4,    1.0,  0.00000,      0,      1,      13,      13,       0,    1637</span><br><span class="line">121 threadCount, READ,         200000,  225275,  225275,  225275,     0.5,     0.4,     0.9,     1.2,    32.9,    65.8,    0.9,  0.00000,      0,      1,      13,      13,       0,    1638</span><br><span class="line">181 threadCount, READ,         200000,  252569,  252569,  252569,     0.7,     0.5,     1.4,     1.7,     2.3,    80.4,    0.8,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">271 threadCount, READ,         200000,  263521,  263521,  263521,     1.0,     0.7,     1.9,     2.8,    14.5,    71.3,    0.8,  0.00000,      0,      1,      12,      12,       0,    1640</span><br><span class="line">406 threadCount, READ,         200000,  301401,  301401,  301401,     1.4,     1.0,     3.2,     5.1,    52.4,    53.6,    0.7,  0.00000,      0,      1,      12,      12,       0,    1640</span><br><span class="line">609 threadCount, READ,         200000,  298018,  298018,  298018,     2.1,     1.2,     5.9,     9.9,    15.4,    35.7,    0.7,  0.00000,      0,      2,      26,      26,       0,    3280</span><br><span class="line">913 threadCount, READ,         200000,  285031,  285031,  285031,     3.4,     1.2,    11.4,    14.0,    36.6,    50.0,    0.7,  0.00000,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<p>CLUSTER44_read_3min.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, READ,        3899838,   21666,   21666,   21666,     0.2,     0.2,     0.2,     0.3,     0.3,    17.5,  180.0,  0.00060,      0,     20,     264,     264,       1,   32759</span><br><span class="line">  8 threadCount, READ,        7168561,   39825,   39825,   39825,     0.2,     0.2,     0.2,     0.3,     0.4,    22.0,  180.0,  0.00043,      0,     36,     477,     477,       2,   58983</span><br><span class="line"> 16 threadCount, READ,       12822843,   71238,   71238,   71238,     0.2,     0.2,     0.3,     0.4,     0.6,    21.8,  180.0,  0.00075,      0,     59,     760,     760,       2,   96665</span><br><span class="line"> 24 threadCount, READ,       17709667,   98387,   98387,   98387,     0.2,     0.2,     0.3,     0.4,     0.8,    21.2,  180.0,  0.00096,      0,     79,     980,     980,       1,  129439</span><br><span class="line"> 36 threadCount, READ,       23887360,  132707,  132707,  132707,     0.3,     0.2,     0.4,     0.5,     0.9,    21.3,  180.0,  0.00101,      0,    105,    1314,    1314,       1,  172032</span><br><span class="line"> 54 threadCount, READ,       31144699,  173025,  173025,  173025,     0.3,     0.3,     0.4,     0.6,     1.2,    27.8,  180.0,  0.00124,      0,    135,    1654,    1654,       1,  221187</span><br><span class="line"> 81 threadCount, READ,       38692768,  214959,  214959,  214959,     0.4,     0.3,     0.6,     0.7,     1.5,    40.2,  180.0,  0.00126,      0,    166,    2010,    2010,       1,  271986</span><br><span class="line">121 threadCount, READ,       46099747,  256109,  256109,  256109,     0.5,     0.4,     0.8,     1.0,     1.7,    42.0,  180.0,  0.00132,      0,    195,    2352,    2352,       1,  319494</span><br><span class="line">181 threadCount, READ,       51810325,  287834,  287834,  287834,     0.6,     0.5,     1.2,     1.5,     2.4,    51.7,  180.0,  0.00156,      0,    218,    2583,    2583,       1,  357188</span><br><span class="line">271 threadCount, READ,       56578917,  314325,  314325,  314325,     0.8,     0.7,     1.7,     2.3,     3.9,    44.5,  180.0,  0.00163,      0,    238,    2818,    2830,       1,  388317</span><br><span class="line">406 threadCount, READ,       59909240,  332826,  332826,  332826,     1.2,     0.9,     2.7,     4.0,    13.9,   208.3,  180.0,  0.00223,      0,    252,    2976,    3000,       1,  409622</span><br><span class="line">609 threadCount, READ,       56825414,  315692,  315692,  315692,     1.9,     1.0,     5.4,     7.1,    15.6,    47.6,  180.0,  0.00207,      0,    238,    2826,    2826,       1,  389955</span><br><span class="line">913 threadCount, READ,       53999369,  299986,  299986,  299986,     3.0,     1.3,     8.9,    11.0,    15.6,   302.9,  180.0,  0.00160,      0,    225,    2755,    2755,       1,  368647</span><br></pre></td></tr></table></figure>
<p>CLUSTER45_write_1M_rows.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Results:</span><br><span class="line">op rate                   : 267419 [WRITE:267419]</span><br><span class="line">partition rate            : 267419 [WRITE:267419]</span><br><span class="line">row rate                  : 267419 [WRITE:267419]</span><br><span class="line">latency mean              : 0.7 [WRITE:0.7]</span><br><span class="line">latency median            : 0.5 [WRITE:0.5]</span><br><span class="line">latency 95th percentile   : 1.2 [WRITE:1.2]</span><br><span class="line">latency 99th percentile   : 1.8 [WRITE:1.8]</span><br><span class="line">latency 99.9th percentile : 31.9 [WRITE:31.9]</span><br><span class="line">latency max               : 218.2 [WRITE:218.2]</span><br><span class="line">Total partitions          : 1000000 [WRITE:1000000]</span><br><span class="line">Total errors              : 0 [WRITE:0]</span><br><span class="line">total gc count            : 4</span><br><span class="line">total gc mb               : 6248</span><br><span class="line">total gc time (s)         : 0</span><br><span class="line">avg gc time(ms)           : 31</span><br><span class="line">stdev gc time(ms)         : 11</span><br><span class="line">Total operation time      : 00:00:03</span><br></pre></td></tr></table></figure>
<p>CLUSTER46_mixed_autorate_50r50w_1M.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line"> 16 threadCount, READ,          74852,   41220,   41220,   41220,     0.3,     0.2,     0.4,     0.8,     2.7,    93.6,    1.8,  0.06069,      0,      1,      92,      92,       0,    1521</span><br><span class="line"> 16 threadCount, WRITE,         25148,   13849,   13849,   13849,     0.3,     0.2,     0.4,     0.8,     3.3,    93.7,    1.8,  0.06069,      0,      1,      92,      92,       0,    1521</span><br><span class="line"> 16 threadCount, total,        100000,   55069,   55069,   55069,     0.3,     0.2,     0.4,     0.8,     1.9,    93.7,    1.8,  0.06069,      0,      1,      92,      92,       0,    1521</span><br><span class="line"> 24 threadCount, READ,          75161,   67239,   67239,   67239,     0.3,     0.2,     0.3,     0.6,     1.6,    50.3,    1.1,  0.12330,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, WRITE,         24839,   22221,   22221,   22221,     0.2,     0.2,     0.3,     0.5,     1.9,    25.5,    1.1,  0.12330,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 24 threadCount, total,        100000,   89460,   89460,   89460,     0.3,     0.2,     0.3,     0.6,     1.8,    50.3,    1.1,  0.12330,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 36 threadCount, READ,          74515,   76617,   76617,   76617,     0.3,     0.2,     0.4,     0.6,     1.1,   174.0,    1.0,  0.00000,      0,      1,     173,     173,       0,    1538</span><br><span class="line"> 36 threadCount, WRITE,         25485,   26204,   26204,   26204,     0.3,     0.2,     0.4,     0.7,    11.9,   174.0,    1.0,  0.00000,      0,      1,     173,     173,       0,    1538</span><br><span class="line"> 36 threadCount, total,        100000,  102821,  102821,  102821,     0.3,     0.2,     0.4,     0.6,     1.0,   174.0,    1.0,  0.00000,      0,      1,     173,     173,       0,    1538</span><br><span class="line"> 54 threadCount, READ,          75025,   92227,   92227,   92227,     0.4,     0.3,     0.5,     0.7,    25.2,   211.2,    0.8,  0.00000,      0,      1,     209,     209,       0,    1553</span><br><span class="line"> 54 threadCount, WRITE,         24975,   30711,   30711,   30711,     0.4,     0.3,     0.5,     0.7,    25.4,   211.3,    0.8,  0.00000,      0,      1,     209,     209,       0,    1553</span><br><span class="line"> 54 threadCount, total,        100000,  122928,  122928,  122928,     0.4,     0.3,     0.5,     0.7,     2.3,   211.3,    0.8,  0.00000,      0,      1,     209,     209,       0,    1553</span><br><span class="line"> 81 threadCount, READ,          74565,  150728,  150728,  150728,     0.4,     0.3,     0.6,     0.9,     1.3,    25.7,    0.5,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, WRITE,         25435,   50799,   50799,   50799,     0.4,     0.3,     0.6,     0.9,     2.0,    31.7,    0.5,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line"> 81 threadCount, total,        100000,  199721,  199721,  199721,     0.4,     0.3,     0.6,     0.9,     1.3,    31.7,    0.5,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, READ,          74804,  162638,  162638,  162638,     0.5,     0.4,     0.8,     1.0,     1.2,    63.8,    0.5,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, WRITE,         25196,   54783,   54783,   54783,     0.6,     0.4,     0.8,     1.3,    63.2,    63.8,    0.5,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">121 threadCount, total,        100000,  217418,  217418,  217418,     0.6,     0.4,     0.8,     1.0,     1.5,    63.8,    0.5,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, READ,          74519,  206697,  206697,  206697,     0.6,     0.5,     1.1,     1.4,    23.4,    24.3,    0.4,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, WRITE,         25481,   70677,   70677,   70677,     0.7,     0.5,     1.1,     1.4,    23.3,    24.1,    0.4,  0.00000,      0,      0,       0,       0,       0,       0</span><br><span class="line">181 threadCount, total,        100000,  277373,  277373,  277373,     0.7,     0.5,     1.1,     1.4,    23.3,    24.3,    0.4,  0.00000,      0,      0,       0,       0,       0,       0</span><br></pre></td></tr></table></figure>
<p>CLUSTER47_blog_insert.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,       232963,    7740,    7740,   10588,     0.4,     0.4,     0.6,     0.7,     0.9,   241.4,   30.1,  0.01115,      0,      3,     634,     634,      22,    4127</span><br><span class="line">  8 threadCount, insert,       436194,   14420,   14420,   19680,     0.5,     0.4,     0.6,     0.7,     1.0,   290.6,   30.2,  0.00780,      0,      7,    1677,    1677,      42,    9298</span><br><span class="line"> 16 threadCount, insert,       720362,   23471,   23471,   32086,     0.6,     0.5,     0.8,     0.9,     1.9,   222.3,   30.7,  0.01669,      0,     14,    2259,    2259,      36,   19650</span><br><span class="line"> 24 threadCount, insert,       762309,   24963,   24963,   34151,     0.8,     0.7,     1.1,     1.4,     6.3,   239.9,   30.5,  0.01428,      0,     16,    2494,    2494,      43,   22431</span><br><span class="line"> 36 threadCount, insert,       782500,   25769,   25769,   35273,     1.3,     1.1,     2.0,     2.4,    13.0,   230.8,   30.4,  0.00666,      0,     15,    2454,    2454,      40,   20885</span><br><span class="line"> 54 threadCount, insert,       779071,   25684,   25684,   35130,     2.0,     1.5,     3.6,     4.1,    13.7,   260.4,   30.3,  0.00705,      0,     18,    2607,    2607,      44,   30028</span><br><span class="line"> 81 threadCount, insert,       799458,   25948,   25948,   35478,     3.0,     2.5,     5.4,     6.6,   144.4,   266.1,   30.8,  0.00924,      0,     15,    2181,    2181,      36,   20905</span><br><span class="line">121 threadCount, insert,       806416,   26515,   26515,   36222,     4.4,     3.8,     8.5,    10.4,   100.2,   262.6,   30.4,  0.00663,      0,     15,    1936,    1936,      42,   20970</span><br><span class="line">181 threadCount, insert,       813139,   26389,   26389,   36115,     6.7,     4.4,    15.7,    18.4,   166.1,   269.2,   30.8,  0.01099,      0,     15,    2067,    2067,      39,   20847</span><br></pre></td></tr></table></figure>
<p>CLUSTER48_blog_mixed.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, insert,        37302,    1185,    1185,    1618,     0.5,     0.4,     0.7,     0.8,     1.4,   232.6,   31.5,  0.00958,      0,      9,     535,     535,      13,   16094</span><br><span class="line">  4 threadCount, singlepost,     73938,    2350,    2287,    2287,     0.8,     0.8,     1.1,     1.2,     1.4,    93.2,   31.5,  0.00958,      0,      9,     535,     535,      13,   16094</span><br><span class="line">  4 threadCount, timeline,      37531,    1193,    1161,    9236,     1.0,     0.9,     1.3,     1.4,     1.7,    93.3,   31.5,  0.00958,      0,      9,     535,     535,      13,   16094</span><br><span class="line">  4 threadCount, total,        148771,    4728,    4633,   13140,     0.8,     0.8,     1.1,     1.3,     1.4,   232.6,   31.5,  0.00958,      0,      9,     535,     535,      13,   16094</span><br><span class="line">  8 threadCount, insert,        74933,    2379,    2379,    3256,     0.5,     0.4,     0.7,     0.8,     7.1,    54.7,   31.5,  0.00967,      0,     13,     473,     473,      10,   20848</span><br><span class="line">  8 threadCount, singlepost,    151072,    4797,    4667,    4667,     0.8,     0.8,     1.0,     1.1,     7.6,    55.8,   31.5,  0.00967,      0,     13,     473,     473,      10,   20848</span><br><span class="line">  8 threadCount, timeline,      75451,    2396,    2331,   18748,     1.0,     0.9,     1.2,     1.4,    10.3,    55.8,   31.5,  0.00967,      0,     13,     473,     473,      10,   20848</span><br><span class="line">  8 threadCount, total,        301456,    9571,    9377,   26671,     0.8,     0.8,     1.1,     1.2,     6.1,    55.8,   31.5,  0.00967,      0,     13,     473,     473,      10,   20848</span><br><span class="line"> 16 threadCount, insert,       145800,    4531,    4531,    6208,     0.5,     0.4,     0.7,     0.8,     1.2,    71.5,   32.2,  0.00600,      0,     21,     832,     832,      11,   34730</span><br><span class="line"> 16 threadCount, singlepost,    294522,    9152,    8910,    8910,     0.8,     0.8,     1.1,     1.2,     6.7,    72.1,   32.2,  0.00600,      0,     21,     832,     832,      11,   34730</span><br><span class="line"> 16 threadCount, timeline,     145130,    4510,    4390,   35766,     1.0,     1.0,     1.3,     1.4,     3.2,    72.4,   32.2,  0.00600,      0,     21,     832,     832,      11,   34730</span><br><span class="line"> 16 threadCount, total,        585452,   18193,   17831,   50885,     0.8,     0.8,     1.1,     1.3,     6.2,    72.4,   32.2,  0.00600,      0,     21,     832,     832,      11,   34730</span><br><span class="line"> 24 threadCount, insert,       205026,    6333,    6333,    8666,     0.5,     0.5,     0.8,     0.9,     2.5,   240.6,   32.4,  0.01018,      0,     23,     900,     900,       8,   37887</span><br><span class="line"> 24 threadCount, singlepost,    407459,   12585,   12271,   12271,     0.9,     0.9,     1.1,     1.3,     2.5,    69.3,   32.4,  0.01018,      0,     23,     900,     900,       8,   37887</span><br><span class="line"> 24 threadCount, timeline,     205264,    6340,    6182,   51336,     1.1,     1.0,     1.3,     1.5,     7.0,    69.7,   32.4,  0.01018,      0,     23,     900,     900,       8,   37887</span><br><span class="line"> 24 threadCount, total,        817749,   25257,   24786,   72273,     0.9,     0.9,     1.2,     1.4,     5.4,   240.6,   32.4,  0.01018,      0,     23,     900,     900,       8,   37887</span><br><span class="line"> 36 threadCount, insert,       288985,    8787,    8787,   12010,     0.6,     0.5,     0.9,     1.1,     7.9,   223.1,   32.9,  0.00892,      0,     32,    1210,    1210,       2,   50873</span><br><span class="line"> 36 threadCount, singlepost,    575082,   17486,   17068,   17068,     1.0,     0.9,     1.2,     1.4,     9.0,   225.5,   32.9,  0.00892,      0,     32,    1210,    1210,       2,   50873</span><br><span class="line"> 36 threadCount, timeline,     287981,    8756,    8548,   72597,     1.2,     1.1,     1.5,     1.7,     8.1,   226.4,   32.9,  0.00892,      0,     32,    1210,    1210,       2,   50873</span><br><span class="line"> 36 threadCount, total,       1152048,   35029,   34403,  101674,     0.9,     0.9,     1.3,     1.5,     2.2,   226.4,   32.9,  0.00892,      0,     32,    1210,    1210,       2,   50873</span><br><span class="line"> 54 threadCount, insert,       386007,   11602,   11602,   15868,     0.7,     0.6,     1.0,     1.3,     4.4,    50.5,   33.3,  0.00845,      0,     40,    1557,    1557,       2,   63491</span><br><span class="line"> 54 threadCount, singlepost,    773934,   23262,   22762,   22762,     1.1,     1.0,     1.5,     1.8,    15.0,    51.3,   33.3,  0.00845,      0,     40,    1557,    1557,       2,   63491</span><br><span class="line"> 54 threadCount, timeline,     387013,   11633,   11381,   99175,     1.3,     1.2,     1.7,     2.1,    18.7,    50.6,   33.3,  0.00845,      0,     40,    1557,    1557,       2,   63491</span><br><span class="line"> 54 threadCount, total,       1546954,   46497,   45746,  137805,     1.1,     1.0,     1.5,     1.9,    13.0,    51.3,   33.3,  0.00845,      0,     40,    1557,    1557,       2,   63491</span><br><span class="line"> 81 threadCount, insert,       440395,   12498,   12498,   17085,     1.2,     1.0,     1.5,     1.8,    15.2,   275.6,   35.2,  0.00697,      0,     43,    1707,    1707,       2,   68157</span><br><span class="line"> 81 threadCount, singlepost,    881687,   25021,   24544,   24544,     1.6,     1.4,     2.0,     2.3,    37.1,    92.8,   35.2,  0.00697,      0,     43,    1707,    1707,       2,   68157</span><br><span class="line"> 81 threadCount, timeline,     441963,   12542,   12299,  109925,     1.8,     1.6,     2.2,     2.6,    39.0,    92.8,   35.2,  0.00697,      0,     43,    1707,    1707,       2,   68157</span><br><span class="line"> 81 threadCount, total,       1764045,   50060,   49340,  151554,     1.5,     1.4,     2.0,     2.4,    35.6,   275.6,   35.2,  0.00697,      0,     43,    1707,    1707,       2,   68157</span><br><span class="line">121 threadCount, insert,       479643,   12574,   12574,   17174,     2.0,     1.8,     2.3,     2.8,    41.4,   277.5,   38.1,  0.00771,      0,     45,    1788,    1788,       1,   71366</span><br><span class="line">121 threadCount, singlepost,    949679,   24896,   24466,   24466,     2.4,     2.2,     2.8,     3.3,    41.6,   239.1,   38.1,  0.00771,      0,     45,    1788,    1788,       1,   71366</span><br><span class="line">121 threadCount, timeline,     476907,   12502,   12289,  112297,     2.6,     2.4,     3.0,     3.5,    42.9,   239.3,   38.1,  0.00771,      0,     45,    1788,    1788,       1,   71366</span><br><span class="line">121 threadCount, total,       1906229,   49971,   49328,  153936,     2.3,     2.1,     2.8,     3.3,    41.8,   277.5,   38.1,  0.00771,      0,     45,    1788,    1788,       1,   71366</span><br><span class="line">181 threadCount, insert,       534496,   12376,   12376,   16912,     3.2,     2.9,     3.5,     4.4,    45.5,   351.2,   43.2,  0.00806,      0,     54,    2139,    2164,       8,   84061</span><br><span class="line">181 threadCount, singlepost,   1070775,   24793,   24419,   24419,     3.6,     3.3,     4.1,     5.4,    45.1,   112.1,   43.2,  0.00806,      0,     54,    2139,    2164,       8,   84061</span><br><span class="line">181 threadCount, timeline,     535592,   12401,   12212,  113584,     3.8,     3.6,     4.3,     5.4,    42.7,   119.9,   43.2,  0.00806,      0,     54,    2139,    2164,       8,   84061</span><br><span class="line">181 threadCount, total,       2140863,   49569,   49007,  154916,     3.5,     3.3,     4.1,     5.2,    44.2,   351.2,   43.2,  0.00806,      0,     54,    2139,    2164,       8,   84061</span><br><span class="line">271 threadCount, insert,       621662,   12450,   12450,   17020,     4.9,     4.5,     5.3,     6.6,    49.1,   352.5,   49.9,  0.00709,      0,     65,    2670,    2670,       8,  105265</span><br><span class="line">271 threadCount, singlepost,   1236932,   24773,   24448,   24448,     5.4,     5.0,     5.9,     7.4,    50.8,   200.2,   49.9,  0.00709,      0,     65,    2670,    2670,       8,  105265</span><br><span class="line">271 threadCount, timeline,     615702,   12331,   12169,  114805,     5.7,     5.3,     6.2,     9.9,    57.4,   200.9,   49.9,  0.00709,      0,     65,    2670,    2670,       8,  105265</span><br><span class="line">271 threadCount, total,       2474296,   49554,   49066,  156273,     5.4,     5.0,     5.9,     7.5,    52.9,   352.5,   49.9,  0.00709,      0,     65,    2670,    2670,       8,  105265</span><br></pre></td></tr></table></figure>
<p>CLUSTER49_blog_q1.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, singlepost,    124438,    4137,    4088,    4088,     0.9,     0.9,     1.2,     1.3,     1.5,    36.0,   30.1,  0.00523,      0,      7,     235,     235,      18,   12655</span><br><span class="line">  8 threadCount, singlepost,    260639,    8663,    8560,    8560,     0.8,     0.9,     1.2,     1.3,     1.5,    31.4,   30.1,  0.00397,      0,      7,     173,     173,       2,   11432</span><br><span class="line"> 16 threadCount, singlepost,    529703,   17591,   17380,   17380,     0.8,     0.8,     1.2,     1.3,     1.7,    27.4,   30.1,  0.00446,      0,     11,     251,     251,       1,   17981</span><br><span class="line"> 24 threadCount, singlepost,    811028,   26917,   26599,   26599,     0.8,     0.7,     1.2,     1.4,     4.0,    27.0,   30.1,  0.00268,      0,     13,     280,     280,       2,   21261</span><br><span class="line"> 36 threadCount, singlepost,   1140114,   37749,   37294,   37294,     0.9,     0.8,     1.3,     1.5,     3.9,    28.3,   30.2,  0.00807,      0,     16,     331,     331,       2,   26171</span><br><span class="line"> 54 threadCount, singlepost,   1169908,   38732,   38262,   38262,     1.3,     1.2,     1.7,     1.9,     7.8,    25.9,   30.2,  0.00498,      0,     15,     300,     300,       2,   24535</span><br><span class="line"> 81 threadCount, singlepost,   1180577,   39018,   38557,   38557,     2.0,     1.9,     2.3,     2.5,    18.2,    70.3,   30.3,  0.00604,      0,     16,     314,     314,       3,   26168</span><br><span class="line">121 threadCount, singlepost,   1186818,   39141,   38676,   38676,     3.0,     3.0,     3.2,     3.4,    14.2,    32.9,   30.3,  0.00262,      0,     12,     223,     223,       4,   19624</span><br><span class="line">181 threadCount, singlepost,   1196971,   39363,   38887,   38887,     4.5,     4.5,     4.7,     4.9,    17.0,    30.4,   30.4,  0.00113,      0,     13,     216,     216,       1,   21263</span><br><span class="line">271 threadCount, singlepost,   1200807,   39256,   38777,   38777,     6.8,     6.7,     7.0,     7.3,    20.3,   169.8,   30.6,  0.00650,      0,     12,     200,     200,       1,   19628</span><br></pre></td></tr></table></figure>
<p>CLUSTER410_blog_q2.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">             id, type,      total ops,    op/s,    pk/s,   row/s,    mean,     med,     .95,     .99,    .999,     max,   time,   stderr, errors,  gc: #,  max ms,  sum ms,  sdv ms,      mb</span><br><span class="line">  4 threadCount, timeline,     150606,    5005,    4945,   46957,     0.7,     0.7,     0.9,     1.0,     1.2,    18.1,   30.1,  0.00308,      0,      9,     134,     134,       1,   14732</span><br><span class="line">  8 threadCount, timeline,     303760,   10097,    9976,   94717,     0.7,     0.7,     0.9,     1.0,     1.2,    19.8,   30.1,  0.00180,      0,     12,     180,     180,       2,   19640</span><br><span class="line"> 16 threadCount, timeline,     586886,   19491,   19260,  182833,     0.7,     0.7,     0.9,     1.0,     1.2,    23.1,   30.1,  0.00684,      0,     22,     292,     292,       2,   36025</span><br><span class="line"> 24 threadCount, timeline,     842276,   27952,   27615,  262067,     0.8,     0.7,     1.0,     1.1,     3.5,    22.5,   30.1,  0.00723,      0,     32,     400,     400,       2,   52404</span><br><span class="line"> 36 threadCount, timeline,    1159174,   38409,   37950,  360174,     0.8,     0.8,     1.1,     1.2,     5.6,    18.6,   30.2,  0.01793,      0,     41,     477,     477,       1,   67158</span><br><span class="line"> 54 threadCount, timeline,    1212693,   40154,   39673,  376526,     1.3,     1.2,     1.5,     1.6,     8.3,    25.2,   30.2,  0.00919,      0,     42,     467,     475,       2,   67169</span><br><span class="line"> 81 threadCount, timeline,    1216916,   40230,   39744,  377269,     1.9,     1.9,     2.1,     2.4,    11.4,    74.0,   30.2,  0.00547,      0,     42,     454,     454,       1,   68812</span><br><span class="line">121 threadCount, timeline,    1228813,   40520,   40037,  379868,     2.9,     2.9,     3.1,     3.4,    10.5,    23.5,   30.3,  0.00332,      0,     42,     461,     461,       1,   68813</span><br><span class="line">181 threadCount, timeline,    1236969,   40658,   40170,  381272,     4.4,     4.3,     4.6,     5.1,    13.7,    27.8,   30.4,  0.00334,      0,     42,     457,     457,       1,   68814</span><br><span class="line">271 threadCount, timeline,    1231892,   40351,   39865,  378388,     6.6,     6.5,     6.8,     7.5,    29.2,   221.9,   30.5,  0.00637,      0,     42,     453,     453,       0,   68813</span><br></pre></td></tr></table></figure>
<h2 id="YCSB">YCSB</h2><p><a href="https://github.com/cloudius-systems/osv/wiki/Benchmarking-Cassandra-and-other-NoSQL-databases-with-YCSB">https://github.com/cloudius-systems/osv/wiki/Benchmarking-Cassandra-and-other-NoSQL-databases-with-YCSB</a></p>
<p>基本命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">加载数据：bin/ycsb load 数据库 -P workloada配置文件 -s</span><br><span class="line">运行测试：bin/ycsb run  数据库 -P workloada配置文件 -s</span><br></pre></td></tr></table></figure>
<p>Cassandra-1.0：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./bin/ycsb load cassandra-10 -p hosts=&quot;192.168.122.89&quot; -P workloads/workloada -s &gt; workloada_load_res.txt</span><br><span class="line">./bin/ycsb run  cassandra-10 -threads 10 -p hosts=&quot;192.168.122.89&quot; -P workloads/workloada -s  &gt; workloada_run_res.txt</span><br><span class="line"></span><br><span class="line">./bin/ycsb load cassandra-10 -P workloads/workloada -p hosts=localhost -p columnfamily=data &gt; ./my-results/load-cassandra-a </span><br><span class="line">./bin/ycsb run  cassandra-10 -P workloads/workloada -p hosts=localhost -p columnfamily=data &gt; ./my-results/run-cassandra-a</span><br></pre></td></tr></table></figure>
<p>workloada配置文件示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hosts=192.168.6.53</span><br><span class="line">cassandra.keyspace=ycsb</span><br><span class="line">recordcount=100000</span><br><span class="line">operationcount=100000</span><br><span class="line">workload=com.yahoo.ycsb.workloads.CoreWorkload </span><br><span class="line">readallfields=true</span><br><span class="line">readproportion=0.5</span><br><span class="line">updateproportion=0.5</span><br><span class="line">scanproportion=0</span><br><span class="line">insertproportion=0</span><br><span class="line">requestdistribution=zipfian</span><br></pre></td></tr></table></figure>
<p>Cassandra-2.0：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./bin/ycsb load cassandra2-cql -P workloada -s</span><br><span class="line">./bin/ycsb run cassandra2-cql -P workloada -s</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
<div class="copyright">
  <p><span>本文标题:</span><a href="/2015/10/15/Cassandra-Stress/">Cassandra压力测试</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 任何忧伤,都抵不过世界的美丽 的个人博客">任何忧伤,都抵不过世界的美丽</a></p>
  <p><span>发布时间:</span>2015年10月15日 - 00时00分</p>
  <p><span>最后更新:</span>2019年02月14日 - 21时42分</p>
  <p>
    <span>原始链接:</span><a href="/2015/10/15/Cassandra-Stress/" title="Cassandra压力测试">http://github.com/zqhxuyuan/2015/10/15/Cassandra-Stress/</a>
    <span class="btn" data-clipboard-text="原文: http://github.com/zqhxuyuan/2015/10/15/Cassandra-Stress/　　作者: 任何忧伤,都抵不过世界的美丽" title="点击复制文章链接">
        <i class="fa fa-clipboard"></i>
    </span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。</p>
  <script src="/js/clipboard.min.js"></script>
  <script> var clipboard = new Clipboard('.btn'); </script>
</div>
<style type="text/css">
  .copyright p .btn {
    margin-left: 1em;
  }
  .copyright:hover p .btn::after {
    content: "复制"
  }
  .copyright p .btn:hover {
      color: gray;
      cursor: pointer;
    };
</style>



<nav id="article-nav">
  
    <div id="article-nav-newer" class="article-nav-title">
      <a href="/2015/10/15/Cassandra-hole/">
        Cassandra陷阱
      </a>
    </div>
  
  
    <div id="article-nav-older" class="article-nav-title">
      <a href="/2015/10/15/Cassandra-exception/">
        Cassandra常见异常
      </a>
    </div>
  
</nav>

  
  
    <div class="post-donate">
	<br>
	<p>
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏"></a>
        <span class="donate_txt">
           &uarr;<br>
		   招人广告：对蚂蚁金服中间件感兴趣的可以发邮件到：qihuang.zqh at antfin.com
        </span>
        <br>
    </div>  
	<div id="donate_guide" class="donate_bar center hidden">
		<img src="/img/zhifubao.png" alt="支付宝打赏"> 
		<img src="/img/weixin.png" alt="微信打赏">  
    </div>
	<script type="text/javascript">
		document.getElementById('btn_donate').onclick = function(){
			$('#donate_board').addClass('hidden');
			$('#donate_guide').removeClass('hidden');
		}
	</script>
</p></div>
  
</article>

<!-- 默认显示文章目录，在文章---前输入toc: false关闭目录 -->
<!-- Show TOC and tocButton in default, Hide TOC via putting "toc: false" before "---" at [post].md -->
<div id="toc" class="toc-article">
<strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#cassandra-stress"><span class="toc-number">1.</span> <span class="toc-text">cassandra-stress</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#介绍"><span class="toc-number">1.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单节点测试"><span class="toc-number">1.2.</span> <span class="toc-text">单节点测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#写入测试"><span class="toc-number">1.2.1.</span> <span class="toc-text">写入测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#采用cql3协议写入"><span class="toc-number">1.2.2.</span> <span class="toc-text">采用cql3协议写入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#读取测试"><span class="toc-number">1.2.3.</span> <span class="toc-text">读取测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#没有预热读取"><span class="toc-number">1.2.4.</span> <span class="toc-text">没有预热读取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#给定一段时间测试最大可以读取多少条记录"><span class="toc-number">1.2.5.</span> <span class="toc-text">给定一段时间测试最大可以读取多少条记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#混合模式读大于写"><span class="toc-number">1.2.6.</span> <span class="toc-text">混合模式读大于写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#混合模式写大于读"><span class="toc-number">1.2.7.</span> <span class="toc-text">混合模式写大于读</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义schema"><span class="toc-number">1.3.</span> <span class="toc-text">自定义schema</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#示例"><span class="toc-number">1.3.1.</span> <span class="toc-text">示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#只有写入"><span class="toc-number">1.3.2.</span> <span class="toc-text">只有写入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#读写混合模式"><span class="toc-number">1.3.3.</span> <span class="toc-text">读写混合模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#只有读取"><span class="toc-number">1.3.4.</span> <span class="toc-text">只有读取</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#G1测试"><span class="toc-number">1.4.</span> <span class="toc-text">G1测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#集群测试"><span class="toc-number">1.5.</span> <span class="toc-text">集群测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#YCSB"><span class="toc-number">2.</span> <span class="toc-text">YCSB</span></a></li></ol>
</div>
<style type="text/css">
  .left-col .switch-btn {
    display: none;
  }
  .left-col .switch-area {
    display: none;
  }
</style>

<input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录">
<script type="text/javascript">
  var toc_button= document.getElementById("tocButton");
  var toc_div= document.getElementById("toc");
  /* Show or hide toc when click on tocButton.
  通过点击设置的按钮显示或者隐藏文章目录.*/
  toc_button.onclick=function(){
  if(toc_div.style.display=="none"){
  toc_div.style.display="block";
  toc_button.value="隐藏目录";
  document.getElementById("switch-btn").style.display="none";
  document.getElementById("switch-area").style.display="none";
  }
  else{
  toc_div.style.display="none";
  toc_button.value="显示目录";
  document.getElementById("switch-btn").style.display="block";
  document.getElementById("switch-area").style.display="block";
  }
  }
    if ($(".toc").length < 1) {
        $("#toc").css("display","none");
        $("#tocButton").css("display","none");
        $(".switch-btn").css("display","block");
        $(".switch-area").css("display","block");
    }
</script>


    <style>
        .toc {
            white-space: nowrap;
            overflow-x: hidden;
        }
    </style>

    <script>
        $(document).ready(function() {
            $(".toc li a").mouseover(function() {
                var title = $(this).attr('href');
                $(this).attr("title", title);
            });
        })
    </script>




<div class="share">
	<div class="bdsharebuttonbox">
	<a href="#" class="bds_more" data-cmd="more"></a>
	<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
	<a href="#" class="bds_copy" data-cmd="copy" title="复制网址"></a>
	<a href="#" class="bds_mail" data-cmd="mail" title="通过邮件分享"></a>
	<a href="#" class="bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
	</div>
	<script>
	window._bd_share_config={
		"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
	</script>
</div>



<div class="duoshuo" id="comments">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="2015/10/15/Cassandra-Stress/" data-title="Cassandra压力测试" data-url="http://github.com/zqhxuyuan/2015/10/15/Cassandra-Stress/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"zqhxuyuan"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>






    <style type="text/css">
    #scroll {
      display: none;
    }
    </style>
    <div class="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
    </div>


  
  
    
    <div class="post-nav-button">
    <a href="/2015/10/15/Cassandra-hole/" title="上一篇: Cassandra陷阱">
    <i class="fa fa-angle-left"></i>
    </a>
    <a href="/2015/10/15/Cassandra-exception/" title="下一篇: Cassandra常见异常">
    <i class="fa fa-angle-right"></i>
    </a>
    </div>
  



    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
        
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2019 任何忧伤,都抵不过世界的美丽
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style="display:none">
        <span id="site-visit">本站到访数: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style="display:none">
        <span id="page-visit">, 本页阅读量: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-80646710-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>